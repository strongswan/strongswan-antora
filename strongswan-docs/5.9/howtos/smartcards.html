<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Smart Card Configuration :: strongSwan Documentation</title>
    <link rel="canonical" href="https://docs.strongswan.org/strongswan-docs/5.9/howtos/smartcards.html">
    <link rel="prev" href="securityRecommendations.html">
    <link rel="next" href="cloudPlatforms.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-extra.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.strongswan.org">strongSwan Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://docs.strongswan.org">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Sites</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://strongswan.org">strongswan.org</a>
             <a class="navbar-item" href="https://github.com/strongswan/strongswan">Source Repository</a>
            <a class="navbar-item" href="https://github.com/strongswan/strongswan-docs">AsciiDoc Repository</a>
         </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://download.strongswan.org">Downloads</a>
            <a class="navbar-item" href="https://lists.strongswan.org/">Mailing Lists</a>
            <a class="navbar-item" href="https://tnc.strongswan.org">strongTNC</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="strongswan-docs" data-version="5.9">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">strongSwan Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/install.html">Installation Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/autoconf.html">Autoconf Options</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/kernelModules.html">Required Kernel Modules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/reducedPrivileges.html">Reduced Privileges</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/trafficDumps.html">Taking Traffic Dumps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../config/config.html">Configuration Files</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/strongswanConf.html">strongswan.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/strongswanDir.html">strongswan.d Directory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlConf.html">swanctl.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlDir.html">swanctl Directory</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/IKEv2CipherSuites.html">IKEv2 Cipher Suites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/identityParsing.html">Identity Parsing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/jobPriority.html">Job Priority Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/lookupTuning.html">Tuning IKE SA Lookup</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/rekeying.html">IKE and IPsec SA Renewal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/retransmission.html">Retransmission</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/sqliteDbSchema.html">SQLite Database Schema</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/IPv6Ndp.html">IPv6 and the Neighbor Discovery Protocol</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Features</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/vip.html">Virtual IP Addresses</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/mobike.html">MOBIKE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/natTraversal.html">NAT Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/networkManager.html">NetworkManager</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/routeBasedVpn.html">Route-based VPN</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/highAvailability.html">High Availability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/hashAndUrl.html">Hash and URL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/integrityTests.html">Integrity Tests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ietf.html">IPsec and Related Standards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Howtos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/quickstart.html">Configuration Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/pkiQuickstart.html">Certificates Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction to strongSwan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="forwarding.html">Forwarding and Split-Tunneling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="securityRecommendations.html">Security Recommendations</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="smartcards.html">Smart Card Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cloudPlatforms.html">Cloud Platforms</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="nameSpaces.html">strongSwan in Linux Network Namespaces</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Daemons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon.html">charon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-systemd.html">charon-systemd</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-svc.html">charon-svc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-cmd.html">charon-cmd</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">OS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../os/android.html">Android</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClient.html">Android VPN Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientProfiles.html">Android VPN Client Profiles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientPrivacyPolicy.html">Android VPN Privacy Policy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientBuild.html">Android VPN Client Build</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/windows.html">Windows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/freebsd.html">FreeBSD</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/macos.html">macOS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Interoperability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html">Windows Clients</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsCertRequirements.html">Windows Certificate Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsMachineCert.html">Storing a Windows Machine Certificate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsMachineConf.html">Windows Client Configuration with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsMachineConnect.html">Windows Client Connection with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsMachineServerConf.html">strongSwan Configuration for Windows Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsMachineServerStatus.html">strongSwan Connection Status with Windows Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsUserCert.html">Storing a Windows User Certificate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsCaCert.html">Storing a Windows CA Certificate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsUserConf.html">Windows Client Configuration with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsUserConnect.html">Windows Client Connection with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsUserServerConf.html">strongSwan Configuration for Windows User Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsUserServerStatus.html">strongSwan Connection Status with Windows User Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsEapConf.html">Windows Client EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsEapConnect.html">Windows Client EAP Connection with Passwords</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsEapServerConf.html">strongSwan EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsEapServerStatus.html">strongSwan EAP Connection Status with Passwords</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/ios.html">iOS and macOS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/appleIkev2Profile.html">Apple IKEv2 Configuration Profile</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interop/fortinet.html">Fortinet Devices</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tools</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../swanctl/swanctl.html">swanctl Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/pki.html">pki Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/scepclient.html">scepclient Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/pt-tls-client.html">pt-tls-client Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/sw-collector.html">sw-collector Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/sec-updater.html">sec-updater Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/pool.html">ipsec pool Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/attest.html">ipsec attest Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/conftest.html">ipsec conftest Tool</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugins</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../plugins/plugins.html">Plugin List</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/addrblock.html">addrblock Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/attr.html">attr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/attr-sql.html">attr-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/bypass-lan.html">bypass-lan Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/certexpire.html">certexpire Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/connmark.html">connmark Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/constraints.html">constraints Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/counters.html">counters Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/coupling.html">coupling Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/curl.html">curl Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/dhcp.html">dhcp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/duplicheck.html">duplicheck Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-dynamic.html">eap-dynamic Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-gtc.html">eap-gtc Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-radius.html">eap-radius Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-simaka-sql.html">eap-simaka-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-tls.html">eap-tls Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/error-notify.html">error-notify Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/ext-auth.html">ext-auth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/farp.html">farp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/forecast.html">forecast Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/ha.html">ha Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-iph.html">kernel-iph Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-libipsec.html">kernel-libipsec Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-wfp.html">kernel-wfp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/load-tester.html">load-tester Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/lookip.html">lookip Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/pkcs11.html">pkcs11 Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/radattr.html">radattr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/resolve.html">resolve Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/selinux.html">selinux Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/socket-win.html">socket-win Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/sql.html">sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/systime-fix.html">systime-fix Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/test-vectors.html">test-vectors Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/tnc-ifmap.html">tnc-ifmap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/tpm.html">tpm Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/unity.html">unity Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/updown.html">updown Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/vici.html">vici Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/whitelist.html">whitelist Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/winhttp.html">winhttp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-eap.html">xauth-eap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-noauth.html">xauth-noauth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-pam.html">xauth-pam Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugins/pluginLoad.html">Plugin Load Options</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Devs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/devs.html">Developer Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/contributions.html">Contributions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/programmingStyle.html">Programming Style</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/objectOrientedC.html">Object Oriented C</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/testingEnvironment.html">Testing Environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/fuzzing.html">Fuzzing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Platform Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tpm/tpm2.html">TPM 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tnc/tnc.html">Trusted Network Connect</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/tncClient.html">TNC Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/tncServer.html">TNC Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Support</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/helpRequests.html">Help Requests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/flawReporting.html">Flaw Reporting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/free.html">Free Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/commercial.html">Commercial Support</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">strongSwan Docs</span>
    <span class="version">5.9</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">strongSwan Docs</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">5.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">strongSwan Docs</a></li>
    <li>Howtos</li>
    <li><a href="smartcards.html">Smart Card Configuration</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/strongswan/strongswan-docs/edit/antora/docs/modules/ROOT/pages/howtos/smartcards.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Smart Card Configuration</h1>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Smart cards are a mature technology that prevents your user credentials from getting
easily compromised by theft. With the
<a href="../plugins/pkcs11.html" class="xref page"><code><strong>pkcs11</strong></code></a> plugin, strongSwan can use any PKCS#11 library
to access smart cards, e.g. the one provided by the <a href="https://github.com/OpenSC/OpenSC/wiki">OpenSC</a> project.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/strongswan-smartcard.png" alt="smart card">
</div>
</div>
<div class="paragraph">
<p>This tutorial gives information on how to use a smartcard reader, initialize cards
and configure strongSwan with smartcards.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compatible_hardware"><a class="anchor" href="#_compatible_hardware"></a>Compatible Hardware</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You need a USB smart card reader and a blank smart card, or a USB token that combines
the two in a convenient form factor, preferably with support of 2048 bit RSA or
256 bit ECDSA keys.</p>
</div>
<div class="sect2">
<h3 id="_compatible_card_readers"><a class="anchor" href="#_compatible_card_readers"></a>Compatible Card Readers</h3>
<div class="paragraph">
<p>Thanks to <a href="https://github.com/OpenSC/OpenSC/wiki">OpenSC</a>, Linux supports most <a href="https://en.wikipedia.org/wiki/CCID_(protocol)">CCID</a> smart card readers,
often using the <a href="https://pcsclite.apdu.fr/">PCSC-Lite</a> library. Most recent USB card readers are compatible.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An overview on smart card readers can be found
<a href="https://github.com/OpenSC/OpenSC/wiki/Smart-card-readers-%28Linux-and-Mac-OS-X%29">here</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_compatible_smart_cards_and_tokens"><a class="anchor" href="#_compatible_smart_cards_and_tokens"></a>Compatible Smart Cards and Tokens</h3>
<div class="ulist">
<ul>
<li>
<p>An overview on smart card readers can be found
<a href="https://github.com/OpenSC/OpenSC/wiki/Supported-hardware-%28smart-cards-and-USB-tokens%29#usb-tokens">here</a>.</p>
</li>
<li>
<p>A list where to buy cards and readers in Europe is given
<a href="https://github.com/OpenSC/OpenSC/wiki/Frequently-Asked-Questions#where-can-i-buy-smart-cards-">here</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preparation"><a class="anchor" href="#_preparation"></a>Preparation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_smart_card_reader"><a class="anchor" href="#_smart_card_reader"></a>Smart Card Reader</h3>
<div class="paragraph">
<p>To install pcsc-tools with CCID support, under Debian based distributions use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo apt-get install pcsc-tools libccid</pre>
</div>
</div>
<div class="paragraph">
<p>strongSwan supports the PKCS#11 standard, which specifies how to access cryptographic
information on devices. Thus, any shared object file that provides a PKCS#11
interface may be used. In this tutorial we use <a href="https://github.com/OpenSC/OpenSC/wiki">OpenSC</a>.</p>
</div>
<div class="paragraph">
<p>To install OpenSC use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo apt-get install opensc</pre>
</div>
</div>
<div class="paragraph">
<p>Do not install the OpenCT package, as it is incompatible with the <code><strong>pcsc-lite</strong></code>
package.</p>
</div>
<div class="paragraph">
<p>Check that the card reader is correctly recognized by OpenSC:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ opensc-tool -l
Readers known about:
Nr.    Driver     Name
0      pcsc       OmniKey CardMan 3121 00 00</pre>
</div>
</div>
<div class="paragraph">
<p>At position Nr. <code><strong>0</strong></code> a Omnikey CardMan 3121 reader has been recognized. Let&#8217;s
insert a smart card in the reader.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When buying a smart card you&#8217;ll also receive a <strong>transport key</strong>. Make sure
      that the <code><strong>transport key</strong></code> proposed by OpenSC matches the one you got in
      the mail. The smart card will be <strong>irretrievably</strong> blocked by entering the
      wrong key three times.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s double check that the card is recognized by printing its ATR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ opensc-tool -r0 -a
3b:9f:95:81:31:fe:9f:00:65:46:53:05:30:06:71:df:00:00:00:81:61:10:c6</pre>
</div>
</div>
<div class="paragraph">
<p>We can also check the name of the card with the <code><strong>-n</strong></code> option (we can omit the
<code><strong>-r0</strong></code> argument since we only have one reader connected)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ opensc-tool -n
Using reader with a card: OmniKey CardMan 3121 00 00
entersafe</pre>
</div>
</div>
<div class="paragraph">
<p>At this point we know both the card and reader are fully recognized and functional.
We can now proceed to erase the card (you will be asked for the transport key you
got in your mail).</p>
</div>
</div>
<div class="sect2">
<h3 id="_certification_authority"><a class="anchor" href="#_certification_authority"></a>Certification Authority</h3>
<div class="paragraph">
<p>To set up your CA you may use OpenSSL or the strongSwan <a href="../pki/pki.html" class="xref page"><code><strong>pki</strong></code></a>
tool. To simplify things you may also use a
<a href="#pki/caManagementGui.adoc" class="xref unresolved">graphical user interface</a> to set up your CA. One
important thing to keep in mind is that you shouldn&#8217;t create private keys with a
key length not supported by your smart card (check the specs to be sure). RSA keys
with a maximum length of 2048 bits are known to work.</p>
</div>
<div class="paragraph">
<p>Make a backup of your keys/certificates and store it in a safe place.</p>
</div>
<div class="paragraph">
<p>With most cards/tokens it is also possible to generate the private keys directly
on the device. This way you can ensure nobody can get their hands on the keys but
you also can&#8217;t create a backup, so any information encrypted with the corresponding
public key will be inaccessible if the card is lost or stolen.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_a_smart_card_with_pkcsc15_init"><a class="anchor" href="#_configuring_a_smart_card_with_pkcsc15_init"></a>Configuring a Smart Card with pkcsc15-init</h3>
<div class="paragraph">
<p>Credentials on smart cards are usually stored according to the PKCS#15 Cryptographic
Token Information Format Standard fully supported by OpenSC. The following command
erases the card and removes the existing PKCS#15 structure and all stored
cryptographic objects</p>
</div>
<div class="literalblock">
<div class="content">
<pre>pkcs15-init --erase-card</pre>
</div>
</div>
<div class="paragraph">
<p>This may result in a error if the card is already blank. With the next command a
fresh PKCS#15 file structure is created on a smart card or crypto token:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>pkcs15-init  --create-pkcs15 --profile pkcs15+onepin \
             --use-default-transport-key \
             --pin 0000 --puk 111111 \
             --label "Test"</pre>
</div>
</div>
<div class="paragraph">
<p>A secret PIN code is stored in an irretrievable location on the smart card. The PIN
will protect the signing operation. If the PIN is entered incorrectly more than
three times then the smart card will be locked and the PUK code can be used to
unlock the card again.</p>
</div>
<div class="paragraph">
<p>Next the private key is transferred to the smart card</p>
</div>
<div class="literalblock">
<div class="content">
<pre>pkcs15-init --auth-id 1 [--id 45] --store-private-key myKey.pem</pre>
</div>
</div>
<div class="paragraph">
<p>By default the PKCS#15 smart card record will be assigned the ID <code><strong>0x45</strong></code>. Using
the <code><strong>--id</strong></code> option, multiple key records can be stored on a smart card.</p>
</div>
<div class="paragraph">
<p>At last we load the matching X.509 certificate onto the smart card</p>
</div>
<div class="literalblock">
<div class="content">
<pre>pkcs15-init --auth-id 1 [--id 45] --store-certificate myCert.pem</pre>
</div>
</div>
<div class="paragraph">
<p>The <code><strong>pkcs15-tool</strong></code> can now be used to verify the contents of the smart card.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>pkcs15-tool --list-pins --list-keys --list-certificates</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_strongswan_configuration"><a class="anchor" href="#_strongswan_configuration"></a>strongSwan Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_pkcs11_plugin"><a class="anchor" href="#_pkcs11_plugin"></a>pkcs11 Plugin</h3>
<div class="paragraph">
<p>To use smart cards with strongSwan the <a href="../plugins/pkcs11.html" class="xref page"><code><strong>pkcs11</strong></code></a> plugin
has to be enabled and configured.</p>
</div>
<div class="paragraph">
<p>Next the PKCS#11 library provided by <a href="https://github.com/OpenSC/OpenSC/wiki">"OpenSC</a> has to be configured in
<a href="../config/strongswanConf.html" class="xref page"><code><strong>strongswan.conf</strong></code></a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  pkcs11 {
    modules {
      opensc {
        path = /usr/lib/x86_64-linux-gnu/opensc-pkcs11.so
      }
    }
  }</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_entering_the_pin_code"><a class="anchor" href="#_entering_the_pin_code"></a>Entering the PIN Code</h3>
<div class="paragraph">
<p>Since the smart card signing operation needed during authentication is protected
by a PIN code, the secret PIN must be made available to the IKE daemon via a
<a href="../swanctl/swanctlConf.html#_secrets_tokensuffix" class="xref page"><code><strong>secrets.token&lt;suffix&gt;</strong></code></a>
subsection in <a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 8.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">handle</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hex-encoded <code>CKA_ID</code> or handle of the private key on the token or
 <a href="../tpm/tpm2.html" class="xref page">TPM 2.0</a>, respectively</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">slot</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional slot number to access the token</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">module</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional PKCS#11 module name to access the token</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pin</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional PIN required to access the key on the token. If none is provided the
 user is prompted during an interactive
 <a href="../swanctl/swanctlLoadCreds.html" class="xref page"><code><strong>swanctl --load-creds</strong></code></a> call</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For gateways that must be able to start IPsec tunnels automatically in unattended
mode after a reboot, the secret PIN can be stored statically, as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre>secrets {
  token-gw {
    handle = 45
    pin = "12345678"
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>On a personal notebook computer that could get stolen, you wouldn&#8217;t want to store
 your PIN in in <a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a>. Thus just omit
 the <code><strong>pin</strong></code> attribute as in
secrets {
  token1 {
    handle = 45
  }
}
Using the <a href="../swanctl/swanctlLoadCreds.html" class="xref page"><code><strong>swanctl --load-creds</strong></code></a> on the
command line before starting the IPsec connection will prompt you for the PIN.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_certificates_and_connections"><a class="anchor" href="#_configuring_certificates_and_connections"></a>Configuring Certificates and Connections</h3>
<div class="paragraph">
<p>The <a href="../plugins/pkcs11.html" class="xref page"><code><strong>pkcs11</strong></code></a> plugin will automatically load all
certificates from the smart card when the daemon initializes it. CA certificates
are also automatically available as trust anchors without the need to copy them
into the <a href="../swanctl/swanctlDir.html" class="xref page"><code><strong>/etc/swanctl/x509ca</strong></code></a> directory first.</p>
</div>
<div class="paragraph">
<p>Therefore it is usually not necessary to configure a <code><strong>local.cert</strong></code> subsection in
<a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a>, instead <code><strong>local.id</strong></code> is configured
to either the <code><strong>subjectDistinguishedName</strong></code> or one of the <code><strong>subjectAltNames</strong></code>
contained in the certificate.</p>
</div>
<div class="paragraph">
<p>For instance if <code><strong>alice@strongswan.org</strong></code> is contained in the certificate as a
<code><strong>subjectAltName</strong></code> extension, simply configure</p>
</div>
<div class="literalblock">
<div class="content">
<pre>connections.&lt;conn&gt;.left.id = alice@strongswan.org</pre>
</div>
</div>
<div class="paragraph">
<p>In situations where multiple certificates match the same identity configuring a
<code><strong>local.cert&lt;suffix&gt;</strong></code> subsection might be necessary</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 8.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cert&lt;suffix&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Since version 5.5.2. Subsection for a certificate candidate to use for
 authentication. Certificates in <code><strong>certs</strong></code> are transmitted as binary blobs whereas
 the <code><strong>cert</strong></code> subsections offer more flexibility</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cert&lt;suffix&gt;.file</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Absolute path to the certificate to load. Passed as-is to the daemon, so it must
 be readable by it. Configure either <code><strong>file</strong></code> or <code><strong>handle</strong></code> but not both in one
 section</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cert&lt;suffix&gt;.handle</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hex-encoded <code>CKA_ID</code> or handle of the certificate on a token or
 <a href="../tpm/tpm2.html" class="xref page">TPM 2.0</a>, respectively. Configure either <code><strong>handle</strong></code> or <code><strong>file</strong></code>
 but not both in one section</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cert&lt;suffix&gt;.slot</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional slot number of the token that stores the certificate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cert&lt;suffix&gt;.module</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional PKCS#11 module name</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This can be the case with some eID cards that contain separate signature and
encryption certificates with the same identities. Thus for instance</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  local {
    ...
    cert-50 {
      handle = 50
    }
  }</pre>
</div>
</div>
<div class="paragraph">
<p>will look in all available modules and slots for ID <code><strong>0x50</strong></code> starting with the
first slot whereas</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  local {
    ...
    cert-50 {
      slot = 4
      handle = 50
    }
  }</pre>
</div>
</div>
<div class="paragraph">
<p>will directly check slot <code><strong>4</strong></code> (which is usually the first slot on the second
reader/token when using the OpenSC library) for a key with ID <code><strong>0x50</strong></code>.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="securityRecommendations.html">Security Recommendations</a></span>
  <span class="next"><a href="cloudPlatforms.html">Cloud Platforms</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <a href="https://www.strongswan.org/"> 
     <img src="../../../_/img/strongswan.png" alt="strongSwan Logo" height="100"
        width="153" style="vertical-align:middle;float:left;margin:0px 20px"></a>
  <p>Copyright &copy; 2021-2022
     <a href="mailto:info@.strongswan.org">The strongSwan Team</a> and individual contributors.
     The <a href="https://github.com/strongswan/strongswan-docs">content</a>
     is provided under a <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license<p>
  <p>The <a href="https://github.com/strongswan/strongswan-antora">UI</a>
     for this site is derived from the Antora default UI and is licensed under
     the <a href="https://www.mozilla.org/en-US/MPL/2.0/">MPL-2.0</a> license.</p>
 </footer>

<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
