<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>updown Plugin :: strongSwan Documentation</title>
    <link rel="canonical" href="https://docs.strongswan.org/docs/5.9/plugins/updown.html">
    <link rel="prev" href="unity.html">
    <link rel="next" href="vici.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-extra.css">
    <meta name="google-site-verification" content="pFYsGHXifqmasGBdCNNgzV4OxVDn2d3Zm0DK9WUYCl0" />
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.strongswan.org">strongSwan Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Sites</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://strongswan.org">strongswan.org</a>
             <a class="navbar-item" href="https://github.com/strongswan/strongswan">Source Repository</a>
            <a class="navbar-item" href="https://github.com/strongswan/strongswan-docs">AsciiDoc Repository</a>
         </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://download.strongswan.org">Downloads</a>
            <a class="navbar-item" href="https://lists.strongswan.org/">Mailing Lists</a>
            <a class="navbar-item" href="https://tnc.strongswan.org">strongTNC</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="5.9">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">strongSwan Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/install.html">Installation Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/autoconf.html">Autoconf Options</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/kernelModules.html">Required Kernel Modules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/reducedPrivileges.html">Reduced Privileges</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/trafficDumps.html">Taking Traffic Dumps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../config/config.html">Configuration Files</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/strongswanConf.html">strongswan.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/strongswanDir.html">strongswan.d Directory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlConf.html">swanctl.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlDir.html">swanctl Directory</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/IKEv2CipherSuites.html">IKEv2 Cipher Suites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/identityParsing.html">Identity Parsing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/jobPriority.html">Job Priority Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/lookupTuning.html">Tuning IKE SA Lookup</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/rekeying.html">IKE and IPsec SA Renewal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/retransmission.html">Retransmission</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/sqliteDbSchema.html">SQLite Database Schema</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/IPv6Ndp.html">IPv6 and the Neighbor Discovery Protocol</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Features</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/vip.html">Virtual IP Addresses</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/mobike.html">MOBIKE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/natTraversal.html">NAT Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ipcomp.html">IPComp</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/networkManager.html">NetworkManager</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/routeBasedVpn.html">Route-based VPN</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/highAvailability.html">High Availability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/hashAndUrl.html">Hash and URL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/integrityTests.html">Integrity Tests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ietf.html">IPsec and Related Standards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Howtos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/quickstart.html">Configuration Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/pkiQuickstart.html">Certificates Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/caManagement.html">GUI-based CA Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/introduction.html">Introduction to strongSwan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/ipsecProtocol.html">IPsec Protocol</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/forwarding.html">Forwarding and Split-Tunneling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/securityRecommendations.html">Security Recommendations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/smartcards.html">Smart Card Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/cloudPlatforms.html">Cloud Platforms</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/nameSpaces.html">strongSwan in Linux Network Namespaces</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Daemons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon.html">charon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-systemd.html">charon-systemd</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-svc.html">charon-svc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-cmd.html">charon-cmd</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">OS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../os/android.html">Android</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClient.html">Android VPN Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientProfiles.html">Android VPN Client Profiles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientPrivacyPolicy.html">Android VPN Privacy Policy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientBuild.html">Android VPN Client Build</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/windows.html">Windows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/freebsd.html">FreeBSD</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/macos.html">macOS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Interoperability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html">Windows Clients</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsCertRequirements.html">Windows Certificate Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_x_509_machine_certificates">Using Machine Certificates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineCert.html">Storing a Windows Machine Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineConf.html">Windows Client Configuration with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineConnect.html">Windows Client Connection with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineServerConf.html">strongSwan Configuration for Windows Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineServerStatus.html">strongSwan Connection Status with Windows Machine Certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_x_509_user_certificates">Using User Certificates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserCert.html">Storing a Windows User Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsCaCert.html">Storing a Windows CA Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserConf.html">Windows Client Configuration with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserConnect.html">Windows Client Connection with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserServerConf.html">strongSwan Configuration for Windows User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserServerStatus.html">strongSwan Connection Status with Windows User Certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_passwords_with_eap_mschapv2">Using EAP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapConf.html">Windows Client EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapConnect.html">Windows Client EAP Connection with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapServerConf.html">strongSwan EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapServerStatus.html">strongSwan EAP Connection Status with Passwords</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/ios.html">iOS and macOS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/appleIkev2Profile.html">Apple IKEv2 Configuration Profile</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interop/fortinet.html">Fortinet Devices</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tools</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../swanctl/swanctl.html">swanctl Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/pki.html">pki Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/scepclient.html">scepclient Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/pt-tls-client.html">pt-tls-client Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/sw-collector.html">sw-collector Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/sec-updater.html">sec-updater Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/pool.html">ipsec pool Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/attest.html">ipsec attest Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/conftest.html">ipsec conftest Tool</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugins</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="plugins.html">Plugin List</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="addrblock.html">addrblock Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="attr.html">attr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="attr-sql.html">attr-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bypass-lan.html">bypass-lan Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="certexpire.html">certexpire Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="connmark.html">connmark Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="constraints.html">constraints Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="counters.html">counters Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="coupling.html">coupling Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="curl.html">curl Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dhcp.html">dhcp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="duplicheck.html">duplicheck Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eap-dynamic.html">eap-dynamic Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eap-gtc.html">eap-gtc Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eap-radius.html">eap-radius Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eap-simaka-sql.html">eap-simaka-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eap-tls.html">eap-tls Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="error-notify.html">error-notify Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ext-auth.html">ext-auth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="farp.html">farp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="forecast.html">forecast Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ha.html">ha Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kernel-iph.html">kernel-iph Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kernel-libipsec.html">kernel-libipsec Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kernel-wfp.html">kernel-wfp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="load-tester.html">load-tester Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lookip.html">lookip Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pkcs11.html">pkcs11 Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="radattr.html">radattr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resolve.html">resolve Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="selinux.html">selinux Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="socket-win.html">socket-win Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sql.html">sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="systime-fix.html">systime-fix Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="test-vectors.html">test-vectors Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tnc-ifmap.html">tnc-ifmap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tpm.html">tpm Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="unity.html">unity Plugin</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="updown.html">updown Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vici.html">vici Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="whitelist.html">whitelist Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="winhttp.html">winhttp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xauth-eap.html">xauth-eap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xauth-noauth.html">xauth-noauth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xauth-pam.html">xauth-pam Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pluginLoad.html">Plugin Load Options</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Devs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/devs.html">Developer Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/contributions.html">Contributions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/programmingStyle.html">Programming Style</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/objectOrientedC.html">Object Oriented C</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/testingEnvironment.html">Testing Environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/fuzzing.html">Fuzzing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Platform Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tpm/tpm2.html">TPM 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tnc/tnc.html">Trusted Network Connect</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/tncClient.html">TNC Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/tncServer.html">TNC Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/optimumTncSizes.html">Optimum PB-TNC Batch and PA-TNC Message Sizes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/strongTnc.html">strongTNC</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Support</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/helpRequests.html">Help Requests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/faq.html">FAQ</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/flawReporting.html">Flaw Reporting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/free.html">Free Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/commercial.html">Commercial Support</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">strongSwan Docs</span>
    <span class="version">5.9</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">strongSwan Docs</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">5.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">strongSwan Docs</a></li>
    <li>Plugins</li>
    <li><a href="plugins.html">Plugin List</a></li>
    <li><a href="updown.html">updown Plugin</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/strongswan/strongswan-docs/edit/master/docs/modules/ROOT/pages/plugins/updown.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">updown Plugin</h1>
<div class="sect1">
<h2 id="_purpose"><a class="anchor" href="#_purpose"></a>Purpose</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code><strong>updown</strong></code> plugin for <code><strong>libcharon</strong></code> invokes a script when an IKEv2 <code>CHILD SA</code>
or an IKEv1 <code>Quick Mode</code> gets established or deleted.</p>
</div>
<div class="paragraph">
<p>The plugin is enabled by default, but can be disabled with the
<a href="../install/autoconf.html" class="xref page"><code><strong>./configure</strong></code></a> option</p>
</div>
<div class="literalblock">
<div class="content">
<pre>--disable-updown</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To invoke the default <code><strong>_updown</strong></code> script with
<a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a> pass the absolute path to it in</p>
</div>
<div class="literalblock">
<div class="content">
<pre>connections.&lt;conn&gt;.children.&lt;child&gt;.updown</pre>
</div>
</div>
<div class="paragraph">
<p>and add the <code><strong>iptables</strong></code> argument so that the default behavior is triggered, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>updown = /usr/libexec/ipsec/_updown iptables</pre>
</div>
</div>
<div class="paragraph">
<p>The default <code><strong>_updown</strong></code> script installs <code><strong>ACCEPT</strong></code> Netfilter rules in the Linux
kernel by invoking <code><strong>iptables</strong></code> for the established traffic selectors, allowing
default <code><strong>DROP</strong></code> policies. If the local traffic selector is not a single host
then the option</p>
</div>
<div class="literalblock">
<div class="content">
<pre>connections.&lt;conn&gt;.children.&lt;child&gt;.hostaccess = yes</pre>
</div>
</div>
<div class="paragraph">
<p>in <a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a> inserts rules in the <code>INPUT</code>
and <code>OUTPUT</code> chains, besides the rules in the <code>FORWARD</code> chain, that allow
accessing the VPN server itself. Please refer to the <code><strong>_updown</strong></code> script for
details.</p>
</div>
<div class="paragraph">
<p>Alternatively, an arbitrary script can be configured via the <code><strong>updown</strong></code> attribute
in <a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a>  to install custom firewall
rules or perform other actions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_behavior"><a class="anchor" href="#_behavior"></a>Behavior</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The plugin allows the invocation of custom commands associated with <code>CHILD SA up</code>
and <code>CHILD SA down</code> events. The script is compatible to the <code><strong>_updown</strong></code> script
originally used by the <code><strong>pluto</strong></code> IKEv1 daemon.</p>
</div>
<div class="sect2">
<h3 id="_updown_script_interface"><a class="anchor" href="#_updown_script_interface"></a>Updown Script Interface</h3>
<div class="paragraph">
<p>The following <code>PLUTO</code> environment variables are passed to the <code><strong>_updown</strong></code> script:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indicates what version of this interface is being used. This document describes
 version 1.1 which is upwardly compatible with version 1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_VERB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies the name of the operation to be performed (<code>up-host</code>, <code>up-client</code>,
 <code>down-host</code>, or <code>down-client</code>). If the address family for security gateway to
 security gateway communications is IPv6, then a suffix of -v6 is added to the
 verb</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_CONNECTION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the name of the connection for which we are routing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_INTERFACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the name of the ipsec interface to be used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_REQID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the reqid of the ESP or AH policy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PROTO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the negotiated IPsec protocol, <code>ah</code> or <code>esp</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_IPCOMP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is not empty if IPComp was negotiated</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_UNIQUEID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the unique identifier of the associated IKE_SA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_ME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the IP address of our host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MY_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the ID of our host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MY_CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the IP address/netmask in CIDR format of our client subnet.  If the client
 is just the host, this will be the host&#8217;s own IP address/max (where max is 32
 for IPv4 and 128 for IPv6)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MY_SOURCEIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is a legacy variable and equals the first virtual IP (either IPv4 or IPv6)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MY_SOURCEIP4_$i</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains a IPv4 virtual IP received from a responder where $i enumerates from 1
 to the number of IPs per address family</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MY_SOURCEIP6_$i</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains a IPv6 virtual IP received from a responder where $i enumerates from 1
 to the number of IPs per address family</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MY_PROTOCOL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the IP protocol that will be transported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MY_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the UDP/TCP port to which the IPsec SA is restricted on our side. For
 ICMP/ICMPv6 this contains the message type and PLUTO_PEER_PORT the message code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PEER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the IP address of our peer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PEER_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the ID of our peer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PEER_CLIENT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the IP address/netmask in CIDR format of the peer&#8217;s client subnet. If the
 client is just the peer, this will be the peer&#8217;s own IP address/max (where max
 is 32 for IPv4 and 128 for IPv6).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PEER_SOURCEIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is a legacy variable and equals the first virtual IP (either IPv4 or IPv6)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PEER_SOURCEIP4_$i</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains a IPv4 virtual IP sent to an initiator where $i enumerates from 1 to
 the number of IPs per address family</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PEER_SOURCEIP6_$i</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains a IPv6 virtual IP sent to an initiator where $i enumerates from 1 to
 the number of IPs per address family</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PEER_PROTOCOL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the IP protocol that will be transported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_PEER_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the UDP/TCP port to which the IPsec SA is restricted on the peer side. For
 ICMP/ICMPv6 this contains the message code and PLUTO_MY_PORT the message type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_XAUTH_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is an optional user ID employed by the XAUTH protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MARK_IN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is an optional XFRM mark set on the inbound IPsec SA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_MARK_OUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is an optional XFRM mark set on the outbound IPsec SA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_IF_ID_IN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is an optional XFRM interface ID set on the inbound IPsec SA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_IF_ID_OUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is an optional XFRM interface ID set on the outbound IPsec SA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_UDP_ENC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains the remote UDP port in the case of ESP_IN_UDP encapsulation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_DNS4_$i</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains an IPv4 DNS server attribute received from a responder, $i enumerates
 from 1 to the number of servers per address family</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLUTO_DNS6_$i</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains an IPv6 DNS server attribute received from a responder, $i enumerates
 from 1 to the number of servers per address family</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_updown_events"><a class="anchor" href="#_updown_events"></a>Updown Events</h3>
<div class="paragraph">
<p>The <code><strong>updown</strong></code> plugin invokes the script hook with the following <code><strong>PLUTO_VERB</strong></code>
values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">PLUTO_VERB</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">up-host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHILD SA up</code> event, where the negotiated local traffic selector is a single
 IPv4 host</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">up-host-v6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHILD SA up</code> event, where the negotiated local traffic selector is a single
 IPv6 host</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">up-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHILD_SA up</code> event, where the negotiated local traffic selector is an
 IPv4 subnet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">up-client-v6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHILD_SA up</code> event, where the negotiated local traffic selector is an
 IPv6 subnet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">down-host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHILD_SA down</code> event, counterpart of up-host</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">down-host-v6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHILD_SA down</code> event, counterpart of up-host-v6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">down-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHILD_SA down</code> event, counterpart of up-client</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">down-client-v6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHILD_SA down</code> event, counterpart of up-client-v6</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While <code>CHILD SA</code> rekeying establishes a new <code>CHILD SA</code>, the hooks do
      not get invoked.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With IKEv2 a negotiated <code>CHILD SA</code> may contain multiple hosts or subnets in the
negotiated traffic selectors. To keep compatibility with the scripts originally
designed for IKEv1, the script gets invoked for each traffic selector
combination once. This means with multiple traffic selectors,
establishing/closing a <code>CHILD SA</code> invokes the script more than once.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging"><a class="anchor" href="#_logging"></a>Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default <em>updown</em> script additionally logs the <code>CHILD SA</code> event to <code><strong>syslog</strong></code>.
This behavior can be disabled by commenting out the <code><strong>VPN_LOGGING</strong></code> option in
the script.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_alternatives"><a class="anchor" href="#_alternatives"></a>Alternatives</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code><strong>updown</strong></code> script allows the installation of custom `<strong>iptables</strong>`rules and
often it is very simple to implement custom logic. It has, however, some
limitations for historical reasons and might not scale with a lot of tunnels.</p>
</div>
<div class="paragraph">
<p>To accept traffic with default <code>DROP</code> policies, one may alternatively use global,
non-tunnel specific rules matching IPsec traffic with the Netfilter <code><strong>policy</strong></code>
match.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="unity.html">unity Plugin</a></span>
  <span class="next"><a href="vici.html">vici Plugin</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <a href="https://www.strongswan.org/"> 
     <img src="../../../_/img/strongswan.png" alt="strongSwan Logo" height="100"
        width="153" style="vertical-align:middle;float:left;margin:0px 20px"></a>
  <p>Copyright &copy; 2021-2022
     <a href="mailto:info@.strongswan.org">The strongSwan Team</a> and individual contributors.
     The <a href="https://github.com/strongswan/strongswan-docs">content</a>
     is provided under a <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license<p>
  <p>The <a href="https://github.com/strongswan/strongswan-antora">UI</a>
     for this site is derived from the Antora default UI and is licensed under
     the <a href="https://www.mozilla.org/en-US/MPL/2.0/">MPL-2.0</a> license.</p>
 </footer>

<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
