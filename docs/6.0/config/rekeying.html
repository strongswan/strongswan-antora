<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>IKE and IPsec SA Renewal :: strongSwan Documentation</title>
    <link rel="canonical" href="https://docs.strongswan.org/docs/5.9/config/rekeying.html">
    <link rel="prev" href="lookupTuning.html">
    <link rel="next" href="retransmission.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-extra.css">
    <meta name="google-site-verification" content="pFYsGHXifqmasGBdCNNgzV4OxVDn2d3Zm0DK9WUYCl0" />
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.strongswan.org">strongSwan Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://strongswan.org">strongswan.org</a>
        <a class="navbar-item" href="https://download.strongswan.org">Downloads</a>
        <a class="navbar-item" href="https://github.com/strongswan">GitHub</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="6.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all"></button>
    <h3 class="title"><a href="../index.html">strongSwan Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">News</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../news/whatsNew.html">What&#8217;s New in strongSwan 6.0</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/install.html">Installation Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/autoconf.html">Autoconf Options</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/kernelModules.html">Required Kernel Modules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/reducedPrivileges.html">Reduced Privileges</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/trafficDumps.html">Taking Traffic Dumps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="config.html">Configuration Files</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="strongswanConf.html">strongswan.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="strongswanDir.html">strongswan.d Directory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlConf.html">swanctl.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlDir.html">swanctl Directory</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="IKEv2CipherSuites.html">IKEv2 Cipher Suites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="identityParsing.html">Identity Parsing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jobPriority.html">Job Priority Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="lookupTuning.html">Tuning IKE SA Lookup</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="rekeying.html">IKE and IPsec SA Renewal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="retransmission.html">Retransmission</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tlsOptions.html">TLS Options</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sqliteDbSchema.html">SQLite Database Schema</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="IPv6Ndp.html">IPv6 and the Neighbor Discovery Protocol</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Features</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/vip.html">Virtual IP Addresses</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/mobike.html">MOBIKE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/natTraversal.html">NAT Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ipcomp.html">IPComp</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/networkManager.html">NetworkManager</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/routeBasedVpn.html">Route-based VPN</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/highAvailability.html">High Availability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/hashAndUrl.html">Hash and URL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/integrityTests.html">Integrity Tests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ietf.html">IPsec and Related Standards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Howtos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="quickstart.html">Configuration Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/pkiQuickstart.html">Certificates Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/caManagement.html">GUI-based CA Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/introduction.html">Introduction to strongSwan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/ipsecProtocol.html">IPsec Protocol</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/forwarding.html">Forwarding and Split-Tunneling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/securityRecommendations.html">Security Recommendations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/smartcards.html">Smart Card Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/cloudPlatforms.html">Cloud Platforms</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/nameSpaces.html">strongSwan in Linux Network Namespaces</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Daemons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon.html">charon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-systemd.html">charon-systemd</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-svc.html">charon-svc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-cmd.html">charon-cmd</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">OS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../os/android.html">Android</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClient.html">Android VPN Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientProfiles.html">Android VPN Client Profiles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientPrivacyPolicy.html">Android VPN Privacy Policy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientBuild.html">Android VPN Client Build</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/windows.html">Windows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/freebsd.html">FreeBSD</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/macos.html">macOS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Interoperability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html">Windows Clients</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsCertRequirements.html">Windows Certificate Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_x_509_machine_certificates">Using Machine Certificates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineCert.html">Storing a Windows Machine Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineConf.html">Windows Client Configuration with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineConnect.html">Windows Client Connection with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineServerConf.html">strongSwan Configuration for Windows Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineServerStatus.html">strongSwan Connection Status with Windows Machine Certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_x_509_user_certificates">Using User Certificates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserCert.html">Storing a Windows User Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsCaCert.html">Storing a Windows CA Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserConf.html">Windows Client Configuration with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserConnect.html">Windows Client Connection with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserServerConf.html">strongSwan Configuration for Windows User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserServerStatus.html">strongSwan Connection Status with Windows User Certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_passwords_with_eap_mschapv2">Using EAP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapConf.html">Windows Client EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapConnect.html">Windows Client EAP Connection with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapServerConf.html">strongSwan EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapServerStatus.html">strongSwan EAP Connection Status with Passwords</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/microsoftStatusNotify.html">Microsoft Status Notify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/ios.html">iOS and macOS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/appleIkev2Profile.html">Apple IKEv2 Configuration Profile</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interop/fortinet.html">Fortinet Devices</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tools</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../swanctl/swanctl.html">swanctl Tool</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlCounters.html">swanctl --counters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlFlushCerts.html">swanctl --flush-certs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlInitiate.html">swanctl --initiate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlInstall.html">swanctl --install</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListAlgs.html">swanctl --list-algs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListAuths.html">swanctl --list-authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListCerts.html">swanctl --list-certs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListConns.html">swanctl --list-conns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListPols.html">swanctl --list-pols</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListPools.html">swanctl --list-pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListSas.html">swanctl --list-sas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadAll.html">swanctl --load-all</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadAuths.html">swanctl --load-authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadConns.html">swanctl --load-conns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadCreds.html">swanctl --load-creds</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadPools.html">swanctl --load-pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLog.html">swanctl --log</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlRedirect.html">swanctl --redirect</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlRekey.html">swanctl --rekey</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlReloadSettings.html">swanctl --reload-settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlStats.html">swanctl --stats</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlTerminate.html">swanctl --terminate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlUninstall.html">swanctl --uninstall</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlVersion.html">swanctl --version</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../pki/pki.html">pki Tool</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiAcert.html">pki --acert</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiDn.html">pki --dn</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiEst.html">pki --est</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiEstCa.html">pki --estca</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiGen.html">pki --gen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiIssue.html">pki --issue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiKeyid.html">pki --keyid</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiOcsp.html">pki --ocsp</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPkcs12.html">pki --pkcs12</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPkcs7.html">pki --pkcs7</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPrint.html">pki --print</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPub.html">pki --pub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiReq.html">pki --req</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiScep.html">pki --scep</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiScepCa.html">pki --scepca</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiSelf.html">pki --self</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiSignCrl.html">pki --signcrl</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiVerify.html">pki --verify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/cert-enroll.html">cert-enroll Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/pt-tls-client.html">pt-tls-client Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/sw-collector.html">sw-collector Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/sec-updater.html">sec-updater Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/pool.html">ipsec pool Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tnc/attest.html">ipsec attest Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/conftest.html">ipsec conftest Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/scepclient.html">ipsec scepclient Tool</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugins</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../plugins/plugins.html">Plugin List</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/addrblock.html">addrblock Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/attr.html">attr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/attr-sql.html">attr-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/bypass-lan.html">bypass-lan Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/certexpire.html">certexpire Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/connmark.html">connmark Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/constraints.html">constraints Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/counters.html">counters Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/coupling.html">coupling Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/curl.html">curl Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/dhcp.html">dhcp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/duplicheck.html">duplicheck Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-dynamic.html">eap-dynamic Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-gtc.html">eap-gtc Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-radius.html">eap-radius Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-simaka-sql.html">eap-simaka-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-tls.html">eap-tls Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/error-notify.html">error-notify Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/ext-auth.html">ext-auth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/farp.html">farp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/forecast.html">forecast Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/ha.html">ha Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-iph.html">kernel-iph Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-libipsec.html">kernel-libipsec Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-wfp.html">kernel-wfp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/load-tester.html">load-tester Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/lookip.html">lookip Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/openxpki.html">openxpki Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/pkcs11.html">pkcs11 Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/radattr.html">radattr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/resolve.html">resolve Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/save-keys.html">save-keys Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/selinux.html">selinux Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/socket-win.html">socket-win Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/sql.html">sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/systime-fix.html">systime-fix Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/test-vectors.html">test-vectors Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/tnc-ifmap.html">tnc-ifmap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/tpm.html">tpm Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/unity.html">unity Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/updown.html">updown Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/vici.html">vici Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/whitelist.html">whitelist Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/winhttp.html">winhttp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-eap.html">xauth-eap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-noauth.html">xauth-noauth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-pam.html">xauth-pam Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugins/pluginLoad.html">Plugin Load Options</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/devs.html">Developer Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/contributions.html">Contributions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/programmingStyle.html">Programming Style</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/objectOrientedC.html">Object Oriented C</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/testingEnvironment.html">Testing Environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/fuzzing.html">Fuzzing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Platform Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tpm/tpm2.html">TPM 2.0</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tpm/tpm2Ike.html">TPM 2.0 Use with strongSwan IKE Daemon</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tnc/tnc.html">Trusted Network Connect</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/tncClient.html">TNC Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/tncServer.html">TNC Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/optimumTncSizes.html">Optimum PB-TNC Batch and PA-TNC Message Sizes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tnc/strongTnc.html">strongTNC</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tnc/swima.html">Software Inventory</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tnc/swimaClient.html">Software Inventory Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tnc/swimaServer.html">Software Inventory Server</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tnc/measuredBoot.html">Measured Boot</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tnc/attestationClient.html">Attestation Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tnc/attestationServer.html">Attestation Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tnc/pcrBootEvents.html">PCR Boot Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tnc/ima.html">Integrity Measurement Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tnc/imaClient.html">IMA Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tnc/imaServer.html">IMA Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Support</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/helpRequests.html">Help Requests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/faq.html">FAQ</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/flawReporting.html">Flaw Reporting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/free.html">Free Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/commercial.html">Commercial Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Publications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publications/publications.html">Publications and Presentations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://strongswan.org/blog">strongSwan Blog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">strongSwan Docs</span>
    <span class="version">6.0 Beta</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../5.9/index.html">strongSwan Docs</a>
      <ul class="versions">
        <li class="version is-current">
          <a href="../index.html">6.0 Beta</a>
        </li>
        <li class="version is-latest">
          <a href="../../5.9/index.html">5.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../5.9/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">strongSwan Docs</a></li>
    <li>Configuration</li>
    <li><a href="rekeying.html">IKE and IPsec SA Renewal</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">6.0 Beta</button>
  <div class="version-menu">
    <a class="version is-current" href="rekeying.html">6.0 Beta</a>
    <a class="version" href="../../5.9/config/rekeying.html">5.9</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/strongswan/strongswan-docs/edit/docs-6.0/docs/modules/ROOT/pages/config/rekeying.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">IKE and IPsec SA Renewal</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The keys negotiated for <code>IKE SAs</code> and <code>IPsec SAs</code> should only be used for a limited
amount of time. Additionally <code>IPsec SA</code> keys should only encrypt a limited amount
of data. This means that each <code>SA</code> should expire after a specific lifetime or after
a specific data or packet volume. To avoid interruptions, a replacement <code>SA</code> needs
to be negotiated before that happens. This is called <strong>rekeying</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interoperability"><a class="anchor" href="#_interoperability"></a>Interoperability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There may be interoperability issues related to rekeying and reauthentication.
Please refer to <a href="../interop/windowsClients.html#_rekeying_behavior" class="xref page">Windows</a> and
<a href="../interop/ios.html#_ikev2_reauthentication_issues" class="xref page">macOS/iOS</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ike_sas"><a class="anchor" href="#_ike_sas"></a>IKE SAs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Depending on the IKE version there are up to three ways to replace an <code>IKE SA</code>
before it expires.</p>
</div>
<div class="sect2">
<h3 id="_rekeying"><a class="anchor" href="#_rekeying"></a>Rekeying</h3>
<div class="paragraph">
<p>In comparison to <code>IKEv1</code> which only supports reauthentication (see below), <code>IKEv2</code>
provides proper inline rekeying of <code>IKE SAs</code> by use of <code>CREATE_CHILD_SA</code> exchanges.
This means that new keys may be established without any interruption of the
existing <code>IKE</code> and <code>IPsec SAs</code>.</p>
</div>
<div class="paragraph">
<p>This is the default for IKEv2 configurations based on
<a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a> using the
<a href="../plugins/vici.html" class="xref page"><code><strong>vici</strong></code></a> management interface.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reauthentication"><a class="anchor" href="#_reauthentication"></a>Reauthentication</h3>
<div class="paragraph">
<p>This method to renew the <code>IKE</code> keys involves creating a complete <code>IKE SA</code> from
scratch, which includes complete <code>IKE_SA_INIT</code> and <code>IKE_AUTH</code> exchanges and the
recreation of all associated <code>IPsec SAs</code>.</p>
</div>
<div class="paragraph">
<p>The point of a reauthentication, as the term implies, is to redo the
authentication and to verify that the peers still have access to valid credentials.
Without reauthentication it is currently possible to keep a connection alive even
after a peer&#8217;s certificate has expired. Revocation of certificates by means of
<code>CRLs</code> or <code>OCSP</code> is also only checked during authentication.  Reauthentication
also could make sense in cases where smart cards are used for client authentication,
as it ensures that the user still has the smart card inserted and unlocked with
the <code>PIN</code>.</p>
</div>
<div class="paragraph">
<p>Reauthenticating an <code>IKE SA</code> may be done in two ways:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Break-before-make</strong> </dt>
<dd>
<p>This is the <strong>default</strong> behavior of the <code>IKE</code> daemon when
reauthenticating an <code>IKEv2 SA</code>. It means that all <code>IKE_SAs</code> and <code>CHILD SAs</code> are
torn down before recreating them. This will cause some interruptions during
which no <code>IPsec SAs</code> are installed. If trap policies are used it could also
trigger unnecessary acquires and hence duplicate <code>IPsec SAs</code> during that downtime.
To prevent plaintext traffic from leaving the host appropriate firewall rules
or drop policies may be used.</p>
</dd>
<dt class="hdlist1"><strong>Make-before-break</strong> </dt>
<dd>
<p>This method first creates duplicates of the <code>IKE SAs</code> and all <code>CHILD SAs</code>
overlapping with the existing ones and then deletes the old ones.
This avoids interruptions but requires that both peers can handle overlapping
<code>SAs</code> (e.g. in regards to virtual IPs, duplicate policies or updown scripts).
It is supported for <code>IKEv2</code> since version 5.3.0 but is disabled by default
and may be enabled by explicitly setting</p>
<div class="listingblock">
<div class="content">
<pre>charon.make_before_break = yes</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <code><strong>make_before_break</strong></code> option was introduced in
<a href="strongswanConf.html" class="xref page"><code><strong>strongswan.conf</strong></code></a> with strongSwan version 5.3.0</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30.7692%;">
<col style="width: 7.6923%;">
<col style="width: 61.5385%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Setting</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">make_before_break</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initiate IKEv2 reauthentication with a <strong>make-before-break</strong> instead of a
 <strong>break-before-make</strong> scheme. Make-before-break uses overlapping <code>IKE</code> and <code>CHILD SA</code>
 during reauthentication by first recreating all new SAs before deleting the old
 ones. This behavior can be beneficial to avoid connectivity gaps during
 reauthentication, but requires support for overlapping SAs by the peer.
 strongSwan can handle such overlapping SAs since version 5.3.0</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>IKEv1 SAs</code> are also rekeyed/reauthenticated using a <strong>make-before-break</strong> scheme.
However only the <code>IKE SA</code> is affected. <code>IPsec SAs</code> are adopted by the new <code>IKE SA</code>
and not recreated.</p>
</div>
<div class="sect3">
<h4 id="_ikev2_responder_behavior"><a class="anchor" href="#_ikev2_responder_behavior"></a>IKEv2 Responder Behavior</h4>
<div class="paragraph">
<p>Responders that have reauthentication configured will use the <code>AUTH_LIFETIME</code>
notify defined by <a href="https://datatracker.ietf.org/doc/html/rfc4478"><code>RFC 4478</code></a> to demand that clients reauthenticate before
a certain time. If the responder can not initiate the reauthentication itself (e.g.
due to asymmetric authentication like EAP) it will close the <code>IKE_SA</code> if the client
fails to reauthenticate the <code>SA</code> in time. The responder sends the calculated and
randomized reauthentication time to the client (not the hard lifetime of the <code>SA</code>).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Starting with version 5.9.4, the criteria for sending an <code>AUTH_LIFETIME</code>
           notification by the IKE responder have changed: When IKE reauthentication
           is enabled (<code><strong>reauth_time &gt; 0</strong></code>), <code>AUTH_LIFETIME</code> notifies are now only
           sent by a responder if it can&#8217;t reauthenticate the IKE_SA itself due to
           asymmetric authentication (i.e. EAP) or the assignment of virtual IP
           addresses.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that strongSwan as a client will adhere to <code>AUTH_LIFETIME</code> notifies even if
reauthentication is disabled in the config (or configured differently). It
subtracts the locally configured <code><strong>over_time</strong></code> or <code><strong>margintime</strong></code> from the received
<code><strong>lifetime</strong></code> and schedules a reauthentication.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_settings"><a class="anchor" href="#_settings"></a>Settings</h3>
<div class="paragraph">
<p>The following settings control when <code>IKE SAs</code> expire and how and when they are
replaced. Note that both configuration backends support randomization of rekeying
times to avoid collisions.</p>
</div>
<div class="paragraph">
<p>The following parameters are used in the
<a href="../swanctl/swanctlConf.html#_connections" class="xref page"><code><strong>connections</strong></code></a> section of
<a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 8.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description [default]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;conn&gt;.reauth_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0s</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time to schedule IKE reauthentication. IKE reauthentication recreates the
 IKE/ISAKMP SA from scratch and re-evaluates the credentials. In asymmetric
 configurations (with EAP or configuration payloads) it might not be possible to
 actively reauthenticate as responder. The IKEv2 reauthentication lifetime
 negotiation can instruct the client to perform reauthentication. Reauthentication
 is disabled by default. Enabling it usually may lead to small connection
 interruptions as strongSwan uses a <strong>break-before-make</strong> policy with IKEv2 by
 default unless <code><strong>charon.make_before_break = yes</strong></code> is set in
 <a href="strongswanConf.html" class="xref page"><code><strong>strongswan.conf</strong></code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;conn&gt;.rekey_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4h</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IKE rekeying refreshes key material using a Diffie-Hellman key exchange, but does
 not re-check associated credentials. It is supported with IKEv2 only. IKEv1
 performs a reauthentication procedure instead. With the default value, IKE
 rekeying is scheduled every <code><strong>4</strong></code> hours minus the configured <code><strong>rand_time</strong></code>. If
 a <code><strong>reauth_time</strong></code> is configured, <code><strong>rekey_time</strong></code> defaults to zero, disabling
 rekeying. In that case set <code><strong>rekey_time</strong></code> explicitly to both enforce rekeying and
 reauthentication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;conn&gt;.over_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[&#8594;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hard IKE_SA lifetime if rekey/reauth does not complete, as time. To avoid having
 an IKE or ISAKMP connection kept alive if IKE reauthentication or rekeying fails
 perpetually, a maximum hard lifetime may be specified. If the IKE_SA fails to
 rekey or reauthenticate within the specified time, the IKE_SA gets closed.
 In contrast to CHILD_SA rekeying, <code><strong>over_time</strong></code> is relative in time to the
 <code><strong>rekey_time</strong></code> and <code><strong>reauth_time</strong></code> values, as it applies to both.
 The default is 10% of either <code><strong>rekey_time</strong></code> or <code><strong>reauth_time</strong></code>, whichever value
 is larger. [<code>0.1 * max(rekey_time, reauth_time)</code>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;conn&gt;.rand_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[&#8594;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time range from which to choose a random value to subtract from rekey/reauth
 times. To avoid having both peers initiating the rekey/reauth procedure
 simultaneously, a random time gets subtracted from the rekey/reauth times.
 The default is equal to the configured <code><strong>over_time</strong></code>. [<code>over_time</code>]</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ipsec_sas"><a class="anchor" href="#_ipsec_sas"></a>IPsec SAs</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>IPsec SAs</code> or <code>CHILD_SAs</code> are always rekeyed by creating new <code>SAs</code> and then
deleting the old ones. The cryptographic keys may either be derived from the
<code>IKE</code> key material or with a separate Diffie-Hellman (<code>DH</code>) exchange. The latter
is also known as <strong>Perfect Forward Secrecy</strong> (<code>PFS</code>). To use <code>PFS</code>, <code>DH</code> groups
may be added to the proposals for the <code>IPsec SAs</code> e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>esp_proposals = aes128-sha256-modp3072</pre>
</div>
</div>
<div class="paragraph">
<p>in <code>swanctl.conf</code>. To make <code>PFS</code> optional (i.e. let the peer choose whether <code>PFS</code>
is used or not) add proposals with and without <code>DH</code> groups e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>esp_proposals = aes128-sha256-modp3072,aes128-sha256</pre>
</div>
</div>
<div class="sect2">
<h3 id="_ikev2"><a class="anchor" href="#_ikev2"></a>IKEv2</h3>
<div class="paragraph">
<p>There is one important aspect that affects <code>IKEv2</code>. The keys for the <code>CHILD_SA</code>
that is implicitly created with the <code>IKE_AUTH</code> exchange will always be derived
from the <code>IKE</code> key exchange even if <code>PFS</code> is configured. So if the peers disagree
on whether to use <code>PFS</code> or not (or on the DH groups) it will not be known until
the <code>CHILD_SA</code> is first rekeyed with a <code>CREATE_CHILD_SA</code> exchange (and fails).
This is also the reason why you won&#8217;t see a <code>DH</code> group in the status output of
the daemon until the <code>SA</code> is first rekeyed.</p>
</div>
<div class="paragraph">
<p>It&#8217;s possible to force a <code>CHILD_SA</code> rekeying via the
<a href="../swanctl/swanctlRekey.html" class="xref page"> <code><strong>swanctl</strong></code></a> command and the
<a href="../plugins/vici.html" class="xref page"><code><strong>vici</strong></code></a> interface. This could be used to test if there
is a <code>PFS</code> configuration mismatch.</p>
</div>
<div class="paragraph">
<p>Also, since version <code>5.8.0</code> strongSwan supports the initiation of childless
<code>IKE_SAs</code>. If enabled, no <code>CHILD_SA</code> is created during <code>IKE_AUTH</code>. The first
<code>CHILD_SA</code> will be created with a separate <code>CREATE_CHILD_SA</code> exchange. Thus the
configuration issue as described above will be apparent right from the start,
without having to trigger a rekeying or wait for one.</p>
</div>
<div class="sect3">
<h4 id="_child_sa_rekeying_behavior_since_version_5_5_3"><a class="anchor" href="#_child_sa_rekeying_behavior_since_version_5_5_3"></a>CHILD_SA Rekeying Behavior since Version 5.5.3</h4>
<div class="paragraph">
<p>With version <code>5.5.3</code> the behavior during <code>IKEv2</code> <code>CHILD_SA</code> rekeyings has changed
to avoid traffic loss. When responding to a <code>CREATE_CHILD_SA</code> request to rekey a
<code>CHILD_SA</code> the responder already has everything available to install and use the
new <code>CHILD_SA</code>. However, immediately doing so (as strongSwan did before <code>5.5.3</code>)
could lead to lost traffic as the initiator won&#8217;t be able to process inbound
packets until it receives the <code>CREATE_CHILD_SA</code> response and updates the inbound
<code>SA</code>. To avoid this the responder only installs the new inbound <code>SA</code> and delays
installing the outbound <code>SA</code> until it receives the <code>DELETE</code> notify for the
replaced <code>CHILD_SA</code>.</p>
</div>
<div class="paragraph">
<p>The messages transporting these <code>DELETE</code> notifications could reach the peer
before packets sent with the deleted outbound <code>SAs</code> reach it. To reduce the
chance of traffic loss due to this the inbound <code>SA</code> of the replaced <code>CHILD_SA</code>
is not removed for a configurable amount of seconds as defined by the</p>
</div>
<div class="literalblock">
<div class="content">
<pre>charon.delete_rekeyed_delay</pre>
</div>
</div>
<div class="paragraph">
<p>parameter after the <code>DELETE</code> notify has been processed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ikev1"><a class="anchor" href="#_ikev1"></a>IKEv1</h3>
<div class="paragraph">
<p>With <code>IKEv1</code> each Quick Mode exchange uses the complete proposals, so already
the first <code>IPsec SA</code> will use <code>PFS</code> according to the configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_settings_2"><a class="anchor" href="#_settings_2"></a>Settings</h3>
<div class="paragraph">
<p>The following settings control when IPsec SAs expire and when they are replaced.
Note that both configuration backends support randomization of rekeying margins
to avoid collisions.</p>
</div>
<div class="paragraph">
<p>The following parameters are used in the
<a href="../swanctl/swanctlConf.html#_connections_conn_children" class="xref page"><code><strong>connections.&lt;conn&gt;.children</strong></code></a>
section of <a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 8.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description [default]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.rekey_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1h</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time to schedule CHILD_SA rekeying. CHILD_SA rekeying refreshes key material,
 optionally using a Diffie-Hellman exchange if a group is specified in the proposal.
 To avoid rekey collisions initiated by both ends simultaneously, a value in the
 range of <code><strong>rand_time</strong></code> gets subtracted to form the effective soft lifetime. By
 default CHILD_SA rekeying is scheduled every hour, minus <code><strong>rand_time</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.life_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[&#8594;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum lifetime before CHILD_SA gets closed. Usually this hard lifetime is never
 reached, because the CHILD_SA gets rekeyed before. If that fails for whatever
 reason, this limit closes the CHILD_SA. The default is 10% more than the
 <code><strong>rekey_time</strong></code>. [<code>1.1 * rekey_time</code>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.rand_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[&#8594;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time range from which to choose a random value to subtract from <code><strong>rekey_time</strong></code>.
 The default is the difference between <code><strong>life_time</strong></code> and <code><strong>rekey_time</strong></code>.
 [<code>life_time - rekey_time</code>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.rekey_bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of bytes processed before initiating CHILD_SA rekeying. CHILD_SA rekeying
 refreshes key material, optionally using a Diffie-Hellman exchange if a group is
 specified in the proposal. To avoid rekey collisions initiated by both ends
 simultaneously, a value in the range of <code><strong>rand_bytes</strong></code> gets subtracted to form
 the effective soft volume limit. Volume based CHILD_SA rekeying is disabled by
 default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.life_bytes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum bytes processed before CHILD_SA gets closed. Usually this hard volume
 limit is never reached, because the CHILD_SA gets rekeyed before. If that fails
 for whatever reason, this limit closes the CHILD_SA. The default is 10% more than
 <code><strong>rekey_bytes</strong></code>. [<code>1.1 * rekey_bytes</code>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.rand_bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[&#8594;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte range from which to choose a random value to subtract from <code><strong>rekey_bytes</strong></code>.
 The default is the difference between <code><strong>life_bytes</strong></code> and <code><strong>rekey_bytes</strong></code>.
 [<code>life_bytes - rekey_bytes</code>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.rekey_packets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of packets processed before initiating CHILD_SA rekeying. CHILD_SA rekeying
 refreshes key material, optionally using a Diffie-Hellman exchange if a group is
 specified in the proposal. To avoid rekey collisions initiated by both ends
 simultaneously, a value in the range of <code><strong>rand_packets</strong></code> gets subtracted to form
 the effective soft packet count limit. Packet count based CHILD_SA rekeying is
 disabled by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.life_packets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[&#8594;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of packets processed before CHILD_SA gets closed. Usually this
 hard packets limit is never reached, because the CHILD_SA gets rekeyed before.
 If that fails for whatever reason, this limit closes the CHILD_SA. The default
 is 10% more than <code><strong>rekey_bytes</strong></code>. [<code>1.1 * rekey_packets</code>]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;child&gt;.rand_packets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[&#8594;]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Packet range from which to choose a random value to subtract from <code><strong>rekey_packets</strong></code>.
 The default is the difference between <code><strong>life_packets</strong></code> and <code><strong>rekey_packets</strong></code>.
 [<code>life_packets - rekey_packets</code>]</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example"><a class="anchor" href="#_example"></a>Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the default settings in <a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a> the
following times are used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>IKE SA</strong> default:</p>
<div class="listingblock">
<div class="content">
<pre>rekey_time = 4h = 240m
over_time = 0.1 * rekey_time = 24m
rand_time = over_time = 24m

expiry = rekey_time + over_time = 264m
rekey = rekey_time - random(0, rand_time) = [216, 240]m</pre>
</div>
</div>
<div class="paragraph">
<p>Thus the daemon will attempt to rekey the <code>IKE SA</code> at a random time between
<code><strong>216</strong></code> and <code><strong>240</strong></code> minutes after establishing the SA. Or in other words, between
<code><strong>24</strong></code> and <code><strong>48</strong></code> minutes before the SA expires.</p>
</div>
</li>
<li>
<p><strong>IPsec SA</strong> default:</p>
<div class="listingblock">
<div class="content">
<pre>rekey_time = 1h = 60m
life_time = 1.1 * rekey_time = 66m
rand_time = life_time - rekey_time = 6m

expiry = life_time = 66m
rekey = rekey_time - random(0, rand_time) = [54, 60]m</pre>
</div>
</div>
<div class="paragraph">
<p>Thus the daemon will attempt to rekey the <code>IPsec SA</code> at a random time between
<code><strong>54</strong></code> and <code><strong>60</strong></code> minutes after establishing the SA. Or in other words, between
<code><strong>6</strong></code> and <code><strong>12</strong></code> minutes before the SA expires.</p>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since the rekeying of an SA needs some time, the margin values must not be
      set too low.
</td>
</tr>
</table>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="lookupTuning.html">Tuning IKE SA Lookup</a></span>
  <span class="next"><a href="retransmission.html">Retransmission</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <a href="https://www.strongswan.org/"> 
     <img src="../../../_/img/strongswan.png" alt="strongSwan Logo" height="100"
        width="153" style="vertical-align:middle;float:left;margin:0px 20px"></a>
  <p>Copyright &copy; 2021-2023
     <a href="mailto:info@.strongswan.org">The strongSwan Team</a> and individual contributors.
     The <a href="https://github.com/strongswan/strongswan-docs">content</a>
     is provided under a <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license<p>
  <p>The <a href="https://github.com/strongswan/strongswan-antora">UI</a>
     for this site is derived from the Antora default UI and is licensed under
     the <a href="https://www.mozilla.org/en-US/MPL/2.0/">MPL-2.0</a> license.</p>
 </footer>

<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
