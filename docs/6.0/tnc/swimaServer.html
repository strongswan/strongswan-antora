<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Software Inventory Server :: strongSwan Documentation</title>
    <link rel="canonical" href="https://docs.strongswan.org/docs/5.9/tnc/swimaServer.html">
    <link rel="prev" href="swimaClient.html">
    <link rel="next" href="measuredBoot.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-extra.css">
    <meta name="google-site-verification" content="pFYsGHXifqmasGBdCNNgzV4OxVDn2d3Zm0DK9WUYCl0" />
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.strongswan.org">strongSwan Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://strongswan.org">strongswan.org</a>
        <a class="navbar-item" href="https://download.strongswan.org">Downloads</a>
        <a class="navbar-item" href="https://github.com/strongswan">GitHub</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="6.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">strongSwan Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">News</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../news/whatsNew.html">What&#8217;s New in strongSwan 6.0</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/install.html">Installation Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/autoconf.html">Autoconf Options</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/kernelModules.html">Required Kernel Modules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/reducedPrivileges.html">Reduced Privileges</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/trafficDumps.html">Taking Traffic Dumps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../config/config.html">Configuration Files</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/strongswanConf.html">strongswan.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/strongswanDir.html">strongswan.d Directory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlConf.html">swanctl.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlDir.html">swanctl Directory</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/IKEv2CipherSuites.html">IKEv2 Cipher Suites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/identityParsing.html">Identity Parsing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/jobPriority.html">Job Priority Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/lookupTuning.html">Tuning IKE SA Lookup</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/rekeying.html">IKE and IPsec SA Renewal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/retransmission.html">Retransmission</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/tlsOptions.html">TLS Options</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/sqliteDbSchema.html">SQLite Database Schema</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/IPv6Ndp.html">IPv6 and the Neighbor Discovery Protocol</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Features</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/vip.html">Virtual IP Addresses</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/mobike.html">MOBIKE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/natTraversal.html">NAT Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ipcomp.html">IPComp</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/networkManager.html">NetworkManager</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/routeBasedVpn.html">Route-based VPN</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/highAvailability.html">High Availability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/hashAndUrl.html">Hash and URL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/integrityTests.html">Integrity Tests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ietf.html">IPsec and Related Standards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Howtos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/quickstart.html">Configuration Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/pkiQuickstart.html">Certificates Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pki/caManagement.html">GUI-based CA Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/introduction.html">Introduction to strongSwan</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/ipsecProtocol.html">IPsec Protocol</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/forwarding.html">Forwarding and Split-Tunneling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/securityRecommendations.html">Security Recommendations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/smartcards.html">Smart Card Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/cloudPlatforms.html">Cloud Platforms</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/nameSpaces.html">strongSwan in Linux Network Namespaces</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Daemons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon.html">charon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-systemd.html">charon-systemd</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-svc.html">charon-svc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-cmd.html">charon-cmd</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">OS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../os/android.html">Android</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClient.html">Android VPN Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientProfiles.html">Android VPN Client Profiles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientPrivacyPolicy.html">Android VPN Privacy Policy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientBuild.html">Android VPN Client Build</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/windows.html">Windows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/freebsd.html">FreeBSD</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/macos.html">macOS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Interoperability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html">Windows Clients</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsCertRequirements.html">Windows Certificate Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_x_509_machine_certificates">Using Machine Certificates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineCert.html">Storing a Windows Machine Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineConf.html">Windows Client Configuration with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineConnect.html">Windows Client Connection with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineServerConf.html">strongSwan Configuration for Windows Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineServerStatus.html">strongSwan Connection Status with Windows Machine Certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_x_509_user_certificates">Using User Certificates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserCert.html">Storing a Windows User Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsCaCert.html">Storing a Windows CA Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserConf.html">Windows Client Configuration with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserConnect.html">Windows Client Connection with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserServerConf.html">strongSwan Configuration for Windows User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserServerStatus.html">strongSwan Connection Status with Windows User Certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_passwords_with_eap_mschapv2">Using EAP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapConf.html">Windows Client EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapConnect.html">Windows Client EAP Connection with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapServerConf.html">strongSwan EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapServerStatus.html">strongSwan EAP Connection Status with Passwords</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/microsoftStatusNotify.html">Microsoft Status Notify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/ios.html">iOS and macOS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/appleIkev2Profile.html">Apple IKEv2 Configuration Profile</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interop/fortinet.html">Fortinet Devices</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tools</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../swanctl/swanctl.html">swanctl Tool</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlCounters.html">swanctl --counters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlFlushCerts.html">swanctl --flush-certs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlInitiate.html">swanctl --initiate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlInstall.html">swanctl --install</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListAlgs.html">swanctl --list-algs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListAuths.html">swanctl --list-authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListCerts.html">swanctl --list-certs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListConns.html">swanctl --list-conns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListPols.html">swanctl --list-pols</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListPools.html">swanctl --list-pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListSas.html">swanctl --list-sas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadAll.html">swanctl --load-all</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadAuths.html">swanctl --load-authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadConns.html">swanctl --load-conns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadCreds.html">swanctl --load-creds</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadPools.html">swanctl --load-pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLog.html">swanctl --log</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlRedirect.html">swanctl --redirect</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlRekey.html">swanctl --rekey</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlReloadSettings.html">swanctl --reload-settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlStats.html">swanctl --stats</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlTerminate.html">swanctl --terminate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlUninstall.html">swanctl --uninstall</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlVersion.html">swanctl --version</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../pki/pki.html">pki Tool</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiAcert.html">pki --acert</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiDn.html">pki --dn</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiEst.html">pki --est</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiEstCa.html">pki --estca</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiGen.html">pki --gen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiIssue.html">pki --issue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiKeyid.html">pki --keyid</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPkcs12.html">pki --pkcs12</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPkcs7.html">pki --pkcs7</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPrint.html">pki --print</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPub.html">pki --pub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiReq.html">pki --req</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiScep.html">pki --scep</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiScepCa.html">pki --scepca</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiSelf.html">pki --self</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiSignCrl.html">pki --signcrl</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiVerify.html">pki --verify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pt-tls-client.html">pt-tls-client Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sw-collector.html">sw-collector Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sec-updater.html">sec-updater Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/pool.html">ipsec pool Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="attest.html">ipsec attest Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/conftest.html">ipsec conftest Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/scepclient.html">ipsec scepclient Tool</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugins</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../plugins/plugins.html">Plugin List</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/addrblock.html">addrblock Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/attr.html">attr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/attr-sql.html">attr-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/bypass-lan.html">bypass-lan Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/certexpire.html">certexpire Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/connmark.html">connmark Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/constraints.html">constraints Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/counters.html">counters Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/coupling.html">coupling Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/curl.html">curl Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/dhcp.html">dhcp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/duplicheck.html">duplicheck Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-dynamic.html">eap-dynamic Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-gtc.html">eap-gtc Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-radius.html">eap-radius Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-simaka-sql.html">eap-simaka-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-tls.html">eap-tls Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/error-notify.html">error-notify Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/ext-auth.html">ext-auth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/farp.html">farp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/forecast.html">forecast Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/ha.html">ha Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-iph.html">kernel-iph Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-libipsec.html">kernel-libipsec Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-wfp.html">kernel-wfp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/load-tester.html">load-tester Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/lookip.html">lookip Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/pkcs11.html">pkcs11 Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/radattr.html">radattr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/resolve.html">resolve Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/save-keys.html">save-keys Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/selinux.html">selinux Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/socket-win.html">socket-win Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/sql.html">sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/systime-fix.html">systime-fix Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/test-vectors.html">test-vectors Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/tnc-ifmap.html">tnc-ifmap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/tpm.html">tpm Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/unity.html">unity Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/updown.html">updown Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/vici.html">vici Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/whitelist.html">whitelist Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/winhttp.html">winhttp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-eap.html">xauth-eap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-noauth.html">xauth-noauth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-pam.html">xauth-pam Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugins/pluginLoad.html">Plugin Load Options</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/devs.html">Developer Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/contributions.html">Contributions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/programmingStyle.html">Programming Style</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/objectOrientedC.html">Object Oriented C</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/testingEnvironment.html">Testing Environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/fuzzing.html">Fuzzing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Platform Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tpm/tpm2.html">TPM 2.0</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tpm/tpm2Ike.html">TPM 2.0 Use with strongSwan IKE Daemon</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="tnc.html">Trusted Network Connect</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tncClient.html">TNC Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tncServer.html">TNC Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="optimumTncSizes.html">Optimum PB-TNC Batch and PA-TNC Message Sizes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="strongTnc.html">strongTNC</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="swima.html">Software Inventory</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="swimaClient.html">Software Inventory Client</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="swimaServer.html">Software Inventory Server</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="measuredBoot.html">Measured Boot</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="attestationClient.html">Attestation Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="attestationServer.html">Attestation Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pcrBootEvents.html">PCR Boot Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="ima.html">Integrity Measurement Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="imaClient.html">IMA Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="imaServer.html">IMA Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Support</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/helpRequests.html">Help Requests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/faq.html">FAQ</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/flawReporting.html">Flaw Reporting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/free.html">Free Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/commercial.html">Commercial Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Publications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publications/publications.html">Publications and Presentations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://strongswan.org/blog">strongSwan Blog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">strongSwan Docs</span>
    <span class="version">6.0 Beta</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../5.9/index.html">strongSwan Docs</a>
      <ul class="versions">
        <li class="version is-current">
          <a href="../index.html">6.0 Beta</a>
        </li>
        <li class="version is-latest">
          <a href="../../5.9/index.html">5.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../5.9/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">strongSwan Docs</a></li>
    <li>Platform Security</li>
    <li><a href="tnc.html">Trusted Network Connect</a></li>
    <li><a href="swima.html">Software Inventory</a></li>
    <li><a href="swimaServer.html">Software Inventory Server</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">6.0 Beta</button>
  <div class="version-menu">
    <a class="version is-current" href="swimaServer.html">6.0 Beta</a>
    <a class="version" href="../../5.9/tnc/swimaServer.html">5.9</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/strongswan/strongswan-docs/edit/docs-6.0/docs/modules/ROOT/pages/tnc/swimaServer.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Software Inventory Server</h1>
<div class="sect1">
<h2 id="_importing_swid_tags_into_strongtnc_database"><a class="anchor" href="#_importing_swid_tags_into_strongtnc_database"></a>Importing SWID Tags into strongTNC Database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using the <a href="https://github.com/strongswan/swidGenerator"><code><strong>swid_generator</strong></code></a> tool we generate SWID tags
for all installed packages of a given Linux distribution (e.g. <code><strong>Ubuntu 20.04</strong></code>)
on a trusted platform</p>
</div>
<div class="literalblock">
<div class="content">
<pre># swid_generator swid --full &gt; installed.tags</pre>
</div>
</div>
<div class="paragraph">
<p>The <code><strong>--full</strong></code> option includes directory and file information and per default
computes <code>SHA-256</code> file hashes to be used as reference values for all software
packages.</p>
</div>
<div class="paragraph">
<p>The <code><strong>manage.py importswid</strong></code> <a href="https://github.com/strongswan/strongTNC">script</a> imports the collected SWID
tags into the strongTNC database</p>
</div>
<div class="listingblock">
<div class="content">
<pre># /var/www/tnc/manage.py importswid installed.tags
Added Ubuntu_20.04-x86_64-adduser-3.118ubuntu2
Added Ubuntu_20.04-x86_64-apt-2.0.4
Added Ubuntu_20.04-x86_64-base-files-11ubuntu5.3
Added Ubuntu_20.04-x86_64-base-passwd-3.5.47
Added Ubuntu_20.04-x86_64-bash-5.0-6ubuntu1.1
...
Added Ubuntu_20.04-x86_64-zlib1g-1~1.2.11.dfsg-2ubuntu1.3
Added Ubuntu_20.04-x86_64-zlib1g-dev-1~1.2.11.dfsg-2ubuntu1.3</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only the local <code><strong>manage.py importswid</strong></code> command allows to update and overwrite
      SWID tags in the <a href="strongTnc.html" class="xref page">strongTNC</a> database. The
      <a href="strongTnc.html" class="xref page">strongTNC</a> REST API allows an upload of missing SWID
      tags but tags already existing in the database can never be modified
      by remote access.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="swimaClient.html#_checking_for_swid_tags" class="xref page">SWIMA Client</a> &gt;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_swima_imv"><a class="anchor" href="#_swima_imv"></a>SWIMA IMV</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code><strong>SWIMA IMV</strong></code> implements the
<a href="https://datatracker.ietf.org/doc/html/rfc8412">Software Inventory Message and Attributes</a> (SWIMA) extension of the
<a href="https://datatracker.ietf.org/doc/html/rfc5792"><code><strong>PA-TNC</strong></code></a> measurement protocol.</p>
</div>
<div class="sect2">
<h3 id="_plugin_configuration"><a class="anchor" href="#_plugin_configuration"></a>Plugin Configuration</h3>
<div class="paragraph">
<p>In the <a href="../config/strongswanConf.html#_libimcv_plugins_imv_swima" class="xref page"><code><strong>imv-swima</strong></code></a>
subsection of <a href="../config/strongswanConf.html" class="xref page"><code><strong>strongswan.conf</strong></code></a> some parameters
have to be configured. As a minimum the following entries are needed</p>
</div>
<div class="listingblock">
<div class="content">
<pre>libimcv {
  plugins {
    imv-swima {
      rest_api {
        uri = https://admin-user:strongSwan@tnc.example.com/api/
        timeout = 360
      }
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>In the <code><strong>/etc/tnc_config</strong></code> configuration file the <code><strong>OS IMV</strong></code> and the <code><strong>SWIMA IMV</strong></code>
have to enabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#IMV-Configuration

IMV "OS"      /usr/lib/ipsec/imcvs/imv-os.so
IMV "SWIMA"   /usr/lib/ipsec/imcvs/imv-swima.so</pre>
</div>
</div>
<div class="paragraph">
<p>These two Integrity Measurement Verifiers have to be built beforehand with the
<a href="../install/autoconf.html" class="xref page"><code><strong>./configure</strong></code></a> options</p>
</div>
<div class="literalblock">
<div class="content">
<pre>--enable-imv-os --enable-imv-swima</pre>
</div>
</div>
<div class="paragraph">
<p>When the <a href="../daemons/charon.html" class="xref page"><code><strong>charon</strong></code></a> daemon starts up, the IMVs are loaded.
<code><strong>IMV 1 OS</strong></code> and <code><strong>IMV 2 SWIMA</strong></code> subcribe to the standard PA-TNC message subtypes
<code><strong>Operating System</strong></code> and <code><strong>SWIMA</strong></code> defined in the <code><strong>IETF</strong></code> namespace, respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>00[DMN] Starting IKE charon daemon (strongSwan 5.9.7, Linux 5.13.0-40-generic, x86_64)
00[TNC] TNC recommendation policy is 'default'
00[TNC] loading IMVs from '/etc/tnc_config'
00[TNC] added IETF attributes
00[TNC] added ITA-HSR attributes
00[TNC] added PWG attributes
00[TNC] added TCG attributes
00[LIB] libimcv initialized
00[IMV] IMV 1 "OS" initialized
00[TNC] IMV 1 supports 1 message type: 'IETF/Operating System' 0x000000/0x00000001
00[TNC] IMV 1 "OS" loaded from '/usr/lib/ipsec/imcvs/imv-os.so'
00[IMV] IMV 2 "SWIMA" initialized
00[TNC] IMV 2 supports 1 message type: 'IETF/SWIMA' 0x000000/0x00000009
00[TNC] IMV 2 "SWIMA" loaded from '/usr/lib/ipsec/imcvs/imv-swima.so'</pre>
</div>
</div>
<div class="paragraph">
<p><a href="swimaClient.html#_swima_imc" class="xref page">SWIMA Client</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_vpn_configuration"><a class="anchor" href="#_vpn_configuration"></a>VPN Configuration</h3>
<div class="paragraph">
<p>The VPN configuration choses for this example is the same as for the general
<a href="tncServer.html#_tnc_enabled_vpn_server_configuration" class="xref page">TNC server</a> but for
reasons of brevity we will just omit the <code><strong>PT-EAP</strong></code> and <code><strong>IKEv2 EAP</strong></code> transport
layers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pb_tnc_connection"><a class="anchor" href="#_pb_tnc_connection"></a>PB-TNC Connection</h3>
<div class="paragraph">
<p>The TNC server receives the first PB-TNC Client Data batch and assigns the PB-TNC
(TCG TNC IF-TNCCS 2.0) Connection ID <code><strong>1</strong></code> to the connection and also  creates a
new state for both the <code><strong>OS IMV</strong></code> and the <code><strong>SWIMA IMV</strong></code>. The <code><strong>OS IMV</strong></code> gets the
Access requestor&#8217;s identities <code><strong>client.strongswan.org</strong></code> and <code><strong>192.168.0.3</strong></code> from
the TNC server via the <a href="https://trustedcomputinggroup.org/wp-content/uploads/TNC_IFIMV_v1_4_r11.pdf">TNC IF-IMV</a> API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[TNC] assigned TNCCS Connection ID 1
10[IMV] IMV 1 "OS" created a state for IF-TNCCS 2.0 Connection ID 1: +long +excl -soh
10[IMV]   over IF-T for Tunneled EAP 2.0 with maximum PA-TNC message size of 32722 bytes
10[IMV]   user AR identity 'client.strongswan.org' of type username authenticated by certificate
10[IMV]   machine AR identity '192.168.0.3' of type IPv4 address authenticated by unknown method
10[IMV] IMV 2 "SWIMA" created a state for IF-TNCCS 2.0 Connection ID 1: +long +excl -soh
10[IMV]   over IF-T for Tunneled EAP 2.0 with maximum PA-TNC message size of 32722 bytes
10[IMV] IMV 1 "OS" changed state of Connection ID 1 to 'Handshake'
10[IMV] IMV 2 "SWIMA" changed state of Connection ID 1 to 'Handshake'</pre>
</div>
</div>
<div class="paragraph">
<p><a href="swimaClient.html#_pb_tnc_connection" class="xref page">SWIMA Client</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_os_information"><a class="anchor" href="#_os_information"></a>OS Information</h3>
<div class="paragraph">
<p>The TNC server receives a PB-TNC Client Data batch containing a standard
<code><strong>PB-Language-Preference</strong></code> message which sets the preferred language to
English [<code><strong>en</strong></code>] and two PA-TNC messages</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[TNC] received TNCCS batch (313 bytes)
10[TNC] TNC server is handling inbound connection
10[TNC] processing PB-TNC CDATA batch for Connection ID 1
10[TNC] PB-TNC state transition from 'Init' to 'Server Working'
10[TNC] processing IETF/PB-Language-Preference message (31 bytes)
10[TNC] processing IETF/PB-PA message (222 bytes)
10[TNC] processing IETF/PB-PA message (52 bytes)
10[TNC] setting language preference to 'en'</pre>
</div>
</div>
<div class="paragraph">
<p>The first PA-TNC message is of standard subtype <code><strong>Operating System</strong></code> containing
seven PA-TNC attributes is processed by the <code><strong>OS IMV</strong></code>. The most important attribute
is the <code><strong>Device ID</strong></code> defined in the <code><strong>ITA-HSR</strong></code> namespace, since it uniquely
identfies the endpoint to be measured</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[TNC] handling PB-PA message type 'IETF/Operating System' 0x000000/0x00000001
10[IMV] IMV 1 "OS" received message for Connection ID 1 from IMC 1
10[TNC] processing PA-TNC message with ID 0x5331d56c
10[TNC] processing PA-TNC attribute type 'IETF/Product Information' 0x000000/0x00000002
10[TNC] processing PA-TNC attribute type 'IETF/String Version' 0x000000/0x00000004
10[TNC] processing PA-TNC attribute type 'IETF/Numeric Version' 0x000000/0x00000003
10[TNC] processing PA-TNC attribute type 'IETF/Operational Status' 0x000000/0x00000005
10[TNC] processing PA-TNC attribute type 'IETF/Forwarding Enabled' 0x000000/0x0000000b
10[TNC] processing PA-TNC attribute type 'IETF/Factory Default Password Enabled' 0x000000/0x0000000c
10[TNC] processing PA-TNC attribute type 'ITA-HSR/Device ID' 0x00902a/0x00000008
10[IMV] operating system name is 'Ubuntu' from vendor Canonical
10[IMV] operating system version is '20.04 x86_64'
10[IMV] operating system numeric version is 20.4
10[IMV] operational status: operational, result: successful
10[IMV] last boot: May 13 07:23:44 UTC 2022
10[IMV] IPv4 forwarding is enabled
10[IMV] factory default password is disabled
10[IMV] device ID is a488651e36664792b306cf8be72dd630</pre>
</div>
</div>
<div class="paragraph">
<p>The second PA-TNC message is of standard subtype <code><strong>SWIMA</strong></code> and contains a
<code><strong>Segmentation Contract Request</strong></code> attribute defined in the <code><strong>TCG</strong></code> namespace which
proposes to split up huge PA-TNC messages into segments with a maximum size of
<code><strong>32'698</strong></code> bytes each (see
<a href="optimumTncSizes.html#_pa_tnc_message_segmentation" class="xref page">PA-TNC message segmentation</a>),</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[TNC] handling PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009
10[IMV] IMV 2 "SWIMA" received message for Connection ID 1 from IMC 2
10[TNC] processing PA-TNC message with ID 0x853e6d25
10[TNC] processing PA-TNC attribute type 'TCG/Segmentation Contract Request' 0x005597/0x00000021
10[IMV] IMV 2 received a segmentation contract request from IMC 2 for PA message type 'IETF/SWIMA' 0x000000/0x00000009
10[IMV]   no message size limit, maximum segment size of 32698 bytes</pre>
</div>
</div>
<div class="paragraph">
<p><a href="swimaClient.html#_os_information" class="xref page">SWIMA Client</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_software_identifier_events"><a class="anchor" href="#_software_identifier_events"></a>Software Identifier Events</h3>
<div class="paragraph">
<p>The <code><strong>Segmentation Contract Response</strong></code> attribute defined in the <code><strong>TCG</strong></code> namespace is
inserted into a PA-TNC message of standard subtype <code><strong>SWIMA</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[TNC] creating PA-TNC message with ID 0x7ac776c3
10[TNC] creating PA-TNC attribute type 'TCG/Segmentation Contract Response' 0x005597/0x00000022
10[TNC] creating PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009</pre>
</div>
</div>
<div class="paragraph">
<p>The <code><strong>imc_policy_manager</strong></code> program is executed which connects to the TNC database
and assigns the session number <code><strong>1</strong></code> to the current connection <code><strong>1</strong></code>. Only one
measurement workitems is configured in the database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SWIDT</code> - SWID Tag IDs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>which is handled by the <code><strong>SWID IMV</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[IMV] assigned session ID 1 to Connection ID 1
10[IMV] policy: imv_policy_manager start successful
10[IMV] SWIDT workitem 1
10[IMV] IMV 2 handles SWIDT workitem 1</pre>
</div>
</div>
<div class="paragraph">
<p>No policy enforcements are defined for the <code><strong>OS IMV</strong></code>, so standard <code><strong>Assessment
Result</strong></code> and <code><strong>Remediation Instructions</strong></code> are generated and inserted into a
PA-TNC message of standard subtype <code><strong>Operating Systems</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[IMV] IMV 1 has no workitems - no evaluation requested
10[TNC] creating PA-TNC message with ID 0xd86290ad
10[TNC] creating PA-TNC attribute type 'IETF/Assessment Result' 0x000000/0x00000009
10[TNC] creating PA-TNC attribute type 'IETF/Remediation Instructions' 0x000000/0x0000000a
10[TNC] creating PB-PA message type 'IETF/Operating System' 0x000000/0x00000001
10[TNC] IMV 1 provides recommendation 'allow' and evaluation 'don't know'</pre>
</div>
</div>
<div class="paragraph">
<p>The <code><strong>SWIMA IMV</strong></code> creates a <code><strong>Segmentation Contract Request</strong></code> attribute defined in
the <code><strong>TCG</strong></code> namespace which proposes to split up huge PA-TNC messages into segments
with a maximum size of <code><strong>32'698</strong></code> bytes each
(see <a href="optimumTncSizes.html#_pa_tnc_message_segmentation" class="xref page">PA-TNC message
segmentation</a>). This attribute is put together with a standard <code><strong>SWIMA Request</strong></code>
attribute into a PA-TNC message of standard subtype <code><strong>SWIMA</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[IMV] IMV 2 requests a segmentation contract for PA message type 'IETF/SWIMA' 0x000000/0x00000009
10[IMV]   no message size limit, maximum segment size of 32698 bytes
10[IMV] IMV 2 issues sw request 1 with earliest eid 1
10[TNC] creating PA-TNC message with ID 0x60a9b2c0
10[TNC] creating PA-TNC attribute type 'TCG/Segmentation Contract Request' 0x005597/0x00000021
10[TNC] creating PA-TNC attribute type 'IETF/SWIMA Request' 0x000000/0x0000000d
10[TNC] creating PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009</pre>
</div>
</div>
<div class="paragraph">
<p>The three PA-TNC messages are sent in a PB-TNC Server Data batch to the TNC client</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[TNC] TNC server is handling outbound connection
10[TNC] PB-TNC state transition from 'Server Working' to 'Client Working'
10[TNC] creating PB-TNC SDATA batch
10[TNC] adding IETF/PB-PA message
10[TNC] adding IETF/PB-PA message
10[TNC] adding IETF/PB-PA message
10[TNC] sending PB-TNC SDATA batch (277 bytes) for Connection ID 1</pre>
</div>
</div>
<div class="paragraph">
<p>The TNC server receives a maximum size PB-TNC Client Data batch containing a
PA-TNC message</p>
</div>
<div class="listingblock">
<div class="content">
<pre>16[TNC] received TNCCS batch (32754 bytes)
16[TNC] TNC server is handling inbound connection
16[TNC] processing PB-TNC CDATA batch for Connection ID 1
16[TNC] PB-TNC state transition from 'Client Working' to 'Server Working'
16[TNC] processing IETF/PB-PA message (32746 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The PA-TNC message of standard subtype <code><strong>SWIMA</strong></code> contains a <code><strong>Segmentation Contract
Response</strong></code> attribute and a <code><strong>Segment Envelope</strong></code> attribute, both defined in the <code><strong>TGC</strong></code>
namespace. The <code><strong>Segment Envelope</strong></code> encapsulates the first segment of a
<a href="optimumTncSizes.html#_pa_tnc_message_segmentation" class="xref page">segmented PA-TNC message</a>
from which the first 326 event items from a standard <code><strong>Software Identifier Events</strong></code>
attribute are extracted and processed. 69 event items are still to follow</p>
</div>
<div class="listingblock">
<div class="content">
<pre>16[TNC] handling PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009
16[IMV] IMV 2 "SWIMA" received message for Connection ID 1 from IMC 2 to IMV 2
16[TNC] processing PA-TNC message with ID 0xbc19b497
16[TNC] processing PA-TNC attribute type 'TCG/Segmentation Contract Response' 0x005597/0x00000022
16[TNC] processing PA-TNC attribute type 'TCG/Segment Envelope' 0x005597/0x00000023
16[IMV] IMV 2 received a segmentation contract response from IMC 2 for PA message type 'IETF/SWIMA' 0x000000/0x00000009
16[IMV]   no message size limit, maximum segment size of 32698 bytes
16[TNC] received first segment for base message ID 1 (32678 bytes)
16[TNC] processing PA-TNC attribute type 'IETF/SW Identifier Events' 0x000000/0x0000000f
16[LIB] 28 bytes insufficient to parse 56 bytes of data
16[IMV] received software ID events with 326 items for request 1 at last eid 97 of epoch 0x36a4f7bb, 69 items to follow</pre>
</div>
</div>
<div class="paragraph">
<p>The TNC Server requests the next segment via a <code><strong>Next Segment</strong></code> attribute
defined in the <code><strong>TCG</strong></code> namespace inserted into a PA-TNC message of standard subtype
<code><strong>SWIMA</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>16[TNC] creating PA-TNC message with ID 0x37422fc4
16[TNC] creating PA-TNC attribute type 'TCG/Next Segment' 0x005597/0x00000024
16[TNC] creating PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009</pre>
</div>
</div>
<div class="paragraph">
<p>The PA-TNC message is sent in a PB-TNC Server Data batch to the TNC client</p>
</div>
<div class="listingblock">
<div class="content">
<pre>16[TNC] TNC server is handling outbound connection
16[TNC] PB-TNC state transition from 'Server Working' to 'Client Working'
16[TNC] creating PB-TNC SDATA batch
16[TNC] adding IETF/PB-PA message
16[TNC] sending PB-TNC SDATA batch (56 bytes) for Connection ID 1</pre>
</div>
</div>
<div class="paragraph">
<p>The TNC server receives a PB-TNC Client Data batch containing a PA-TNC message</p>
</div>
<div class="listingblock">
<div class="content">
<pre>12[TNC] received TNCCS batch (6951 bytes)
12[TNC] TNC server is handling inbound connection
12[TNC] processing PB-TNC CDATA batch for Connection ID 1
12[TNC] PB-TNC state transition from 'Client Working' to 'Server Working'
12[TNC] processing IETF/PB-PA message (6943 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The PA-TNC message of standard subtype <code><strong>SWIMA</strong></code> carries a <code><strong>Segment Envelope</strong></code>
attribute defined in the <code><strong>TCG</strong></code> namespace. The remaining 69 event items of the
<code><strong>Software Identifier Events</strong></code> attribute are extracted and processed</p>
</div>
<div class="listingblock">
<div class="content">
<pre>12[TNC] handling PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009
12[IMV] IMV 2 "SWIMA" received message for Connection ID 1 from IMC 2 to IMV 2
12[TNC] processing PA-TNC message with ID 0x08899819
12[TNC] processing PA-TNC attribute type 'TCG/Segment Envelope' 0x005597/0x00000023
12[TNC] received last segment for base message ID 1 (6895 bytes)
12[IMV] received software ID events with 69 items for request 1 at last eid 97 of epoch 0x36a4f7bb, 0 items to follow</pre>
</div>
</div>
<div class="paragraph">
<p><a href="swimaClient.html#_software_identifier_events" class="xref page">SWIMA Client</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_missing_swid_tags"><a class="anchor" href="#_missing_swid_tags"></a>Missing SWID Tags</h3>
<div class="paragraph">
<p>Via a REST API the <code><strong>SWIMA IMV</strong></code> checks if matching SWID tags for all
<code><strong>Software Identifiers</strong></code> sent by the endpoint are available in the
<a href="strongTnc.html" class="xref page">strongTNC</a> database. This is the case for the 173 software
packages currently installed on the endpoint because they have already been
imported manually
(see <a href="#_importing_swid_tags_into_strongtnc_database">SWID tag import</a>) but no
SWID tags exist for the 111 removed software packages yet. Therefore a targeted
<code><strong>SWIMA Request</strong></code> is sent in a PA-TNC message of standard subtype <code><strong>SWIMA</strong></code> to the
endpoint, requesting the missing tags</p>
</div>
<div class="listingblock">
<div class="content">
<pre>12[IMV] 111 SWID tag targets
12[IMV]   strongswan.org__Ubuntu_20.04-x86_64-apt-2.0.2
12[IMV]   strongswan.org__Ubuntu_20.04-x86_64-base-files-11ubuntu5
12[IMV]   strongswan.org__Ubuntu_20.04-x86_64-bash-5.0-6ubuntu1
          ...
12[IMV]   strongswan.org__Ubuntu_20.04-x86_64-wget-1.20.3-1ubuntu2
12[IMV]   strongswan.org__Ubuntu_20.04-x86_64-xdg-user-dirs-0.17-2ubuntu1
12[TNC] creating PA-TNC message with ID 0x60d53991
12[TNC] creating PA-TNC attribute type 'IETF/SWIMA Request' 0x000000/0x0000000d
12[TNC] creating PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009</pre>
</div>
</div>
<div class="paragraph">
<p>The PA-TNC message is sent in a PB-TNC Server Data batch to the TNC client</p>
</div>
<div class="listingblock">
<div class="content">
<pre>12[TNC] TNC server is handling outbound connection
12[TNC] PB-TNC state transition from 'Server Working' to 'Client Working'
12[TNC] creating PB-TNC SDATA batch
12[TNC] adding IETF/PB-PA message
12[TNC] sending PB-TNC SDATA batch (7167 bytes) for Connection ID 1</pre>
</div>
</div>
<div class="paragraph">
<p>The TNC server receives a PB-TNC Client Data batch containing a PA-TNC message</p>
</div>
<div class="listingblock">
<div class="content">
<pre>01[TNC] received TNCCS batch (32754 bytes)
01[TNC] TNC server is handling inbound connection
01[TNC] processing PB-TNC CDATA batch for Connection ID 1
01[TNC] PB-TNC state transition from 'Client Working' to 'Server Working'
01[TNC] processing IETF/PB-PA message (32746 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The PA-TNC message of standard subtype <code><strong>SWIMA</strong></code> contains a first fragment of
a standard <code><strong>Software Inventory</strong></code> attribute encapsulated in a <code><strong>Segment Envelope</strong></code>
attribute defined in the <code><strong>TCG</strong></code> namespace. 60 SWID tags are extracted and
stored in the <a href="strongTnc.html" class="xref page">strongTNC</a> database via a REST API call,
51 tags are still to follow</p>
</div>
<div class="listingblock">
<div class="content">
<pre>01[TNC] handling PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009
01[IMV] IMV 2 "SWIMA" received message for Connection ID 1 from IMC 2 to IMV 2
01[TNC] processing PA-TNC message with ID 0xbaca4544
01[TNC] processing PA-TNC attribute type 'TCG/Segment Envelope' 0x005597/0x00000023
01[TNC] received first segment for base message ID 2 (32698 bytes)
01[TNC] processing PA-TNC attribute type 'IETF/SW Inventory' 0x000000/0x00000010
01[LIB] 325 bytes insufficient to parse 448 bytes of data
01[IMV] received software inventory with 60 items for request 1 at last eid 97 of epoch 0x36a4f7bb, 51 items to follow</pre>
</div>
</div>
<div class="paragraph">
<p>Using a <code><strong>Next Segment</strong></code> attribute defined in the <code><strong>TCG</strong></code> namespace carried in
a PA-TNC message of standard subtype <code><strong>SWIMA</strong></code>, the next message segment is requested
from the <code><strong>SWIMA IMC</strong></code> on the endpoint</p>
</div>
<div class="listingblock">
<div class="content">
<pre>01[TNC] creating PA-TNC message with ID 0x23377689
01[TNC] creating PA-TNC attribute type 'TCG/Next Segment' 0x005597/0x00000024
01[TNC] creating PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009</pre>
</div>
</div>
<div class="paragraph">
<p>The PA-TNC Message is sent in a PB-TNC Server Data batch to the TNC client</p>
</div>
<div class="listingblock">
<div class="content">
<pre>01[TNC] TNC server is handling outbound connection
01[TNC] PB-TNC state transition from 'Server Working' to 'Client Working'
01[TNC] creating PB-TNC SDATA batch
01[TNC] adding IETF/PB-PA message
01[TNC] sending PB-TNC SDATA batch (56 bytes) for Connection ID 1</pre>
</div>
</div>
<div class="paragraph">
<p>The TNC server receives a PB-TNC Client Data batch containing a PA-TNC message</p>
</div>
<div class="listingblock">
<div class="content">
<pre>07[TNC] received TNCCS batch (27323 bytes)
07[TNC] TNC server is handling inbound connection
07[TNC] processing PB-TNC CDATA batch for Connection ID 1
07[TNC] PB-TNC state transition from 'Client Working' to 'Server Working'
07[TNC] processing IETF/PB-PA message (27315 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The PA-TNC message of standard subtype <code><strong>SWIMA</strong></code> contains the second and last fragment
of the <code><strong>Software Inventory</strong></code> attribute encapsulated in a <code><strong>Segment Envelope</strong></code>
attribute defined in the <code><strong>TCG</strong></code> namespace. 51 SWID tags are extracted and stored
in the <a href="strongTnc.html" class="xref page">strongTNC</a> database via a REST API call. Since all
required SWID tags are now available, the 395 <code><strong>Software Identifier Events</strong></code> can now
be registered in the <a href="strongTnc.html" class="xref page">strongTNC</a> database via another REST API
call</p>
</div>
<div class="listingblock">
<div class="content">
<pre>07[TNC] handling PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009
07[IMV] IMV 2 "SWIMA" received message for Connection ID 1 from IMC 2 to IMV 2
07[TNC] processing PA-TNC message with ID 0x300b30f7
07[TNC] processing PA-TNC attribute type 'TCG/Segment Envelope' 0x005597/0x00000023
07[TNC] received last segment for base message ID 2 (27267 bytes)
07[IMV] received software inventory with 51 items for request 1 at last eid 97 of epoch 0x36a4f7bb, 0 items to follow
07[IMV] IMV 2 handled SWIDT workitem 1: allow - received 395 SW ID events and 111 SWID tags</pre>
</div>
</div>
<div class="paragraph">
<p><a href="swimaClient.html#_missing_swid_tags" class="xref page">SWIMA Client</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_tnc_assessment_result"><a class="anchor" href="#_tnc_assessment_result"></a>TNC Assessment Result</h3>
<div class="paragraph">
<p>Since all <code><strong>Software Identifier Events</strong></code> and missing SWID tags were successfully
received and stored in the <a href="strongTnc.html" class="xref page">strongTNC</a> database, the <code><strong>SWIMA IMV</strong></code>
generates a standard <code><strong>Assessment Result</strong></code> attribute with the evaluation <code><strong>compliant</strong></code>
and the recommendation <code><strong>allow</strong></code> and inserts it in a PA-TNC message of standard
subtype <code><strong>SWIMA</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>07[TNC] creating PA-TNC message with ID 0x088727cd
07[TNC] creating PA-TNC attribute type 'IETF/Assessment Result' 0x000000/0x00000009
07[TNC] creating PB-PA message type 'IETF/SWIMA' 0x000000/0x00000009
07[TNC] IMV 2 provides recommendation 'allow' and evaluation 'compliant'</pre>
</div>
</div>
<div class="paragraph">
<p>The overall policy recommendation issued by the TNC server is <code><strong>allow</strong></code> and
communicated to the TNC client in the form of a PB-TNC <code><strong>Assessment-Result</strong></code>
and a PB-TNC <code><strong>Access-Recommendation</strong></code> payload, both of which are sent together
with the PA-TNC message from the <code><strong>SWIMA IMV</strong></code> in a PB-TNC Result batch to the
TNC client</p>
</div>
<div class="listingblock">
<div class="content">
<pre>07[TNC] TNC server is handling outbound connection
07[IMV] policy: recommendation for access requestor 192.168.0.3 is allow
07[IMV] policy: imv_policy_manager stop successful
07[IMV] IMV 1 "OS" changed state of Connection ID 1 to 'Allowed'
07[IMV] IMV 2 "SWIMA" changed state of Connection ID 1 to 'Allowed'
07[TNC] PB-TNC state transition from 'Server Working' to 'Decided'
07[TNC] creating PB-TNC RESULT batch
07[TNC] adding IETF/PB-PA message
07[TNC] adding IETF/PB-Assessment-Result message
07[TNC] adding IETF/PB-Access-Recommendation message
07[TNC] sending PB-TNC RESULT batch (88 bytes) for Connection ID 1</pre>
</div>
</div>
<div class="paragraph">
<p>The TNC client replies with a PB-TNC Close batch which causes the PB-TNC connection
to be deleted. Due to the positive final recommendation, the IKEv2 connection is
allowed to complete</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[TNC] received TNCCS batch (8 bytes)
10[TNC] TNC server is handling inbound connection
10[TNC] processing PB-TNC CLOSE batch for Connection ID 1
10[TNC] PB-TNC state transition from 'Decided' to 'End'
10[TNC] final recommendation is 'allow' and evaluation is 'compliant'
10[TNC] policy enforced on peer '192.168.0.3' is 'allow'
10[TNC] policy enforcement point added group membership 'allow'
10[IKE] EAP_TTLS phase2 authentication of 'client.strongswan.org' with EAP_PT_EAP successful
10[IMV] IMV 1 "OS" deleted the state of Connection ID 1
10[IMV] IMV 2 "SWIMA" deleted the state of Connection ID 1
10[TNC] removed TNCCS Connection ID 1</pre>
</div>
</div>
<div class="paragraph">
<p><a href="swimaClient.html#_tnc_assessment_result" class="xref page">SWIMA Client</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_ikev2_authentication_success"><a class="anchor" href="#_ikev2_authentication_success"></a>IKEv2 Authentication Success</h3>
<div class="paragraph">
<p>The EAP TTLS authentication based on a TLS client certificate plus the TNC
measurements was successful. Thus an <code>EAP-SUCCESS</code> message is sent to the EAP client</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[IKE] EAP method EAP_TTLS succeeded, MSK established
10[ENC] generating IKE_AUTH response 114 [ EAP/SUCC ]
10[NET] sending packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (80 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The IKEv2 client sends an <code>AUTH</code> payload depending on the <code>MSK</code> (Master Secret Key)
derived from the <code>EAP-TTLS</code> session</p>
</div>
<div class="listingblock">
<div class="content">
<pre>09[NET] received packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (112 bytes)
09[ENC] parsed IKE_AUTH request 115 [ AUTH ]
09[IKE] authentication of '192.168.0.3' with EAP successful
09[IKE] authentication of 'server.strongswan.org' (myself) with EAP
09[IKE] IKE_SA tnc[2] established between 192.168.0.2[server.strongswan.org]...192.168.0.3[192.168.0.3]</pre>
</div>
</div>
<div class="paragraph">
<p>The IKEv2 server in turn authenticates itself again via an <code>AUTH</code> payload depending
on the <code>EAP-TTLS MSK</code> as well</p>
</div>
<div class="listingblock">
<div class="content">
<pre>09[IKE] scheduling rekeying in 14240s
09[IKE] maximum IKE_SA lifetime 15680s
09[IKE] peer requested virtual IP %any
09[CFG] assigning new lease to 'client.strongswan.org'
09[IKE] assigning virtual IP 10.3.0.1 to peer 'client.strongswan.org'
09[CFG] selected proposal: ESP:AES_GCM_16_256/NO_EXT_SEQ
09[IKE] CHILD_SA tnc{1} established with SPIs cf7fb53d_i c7d3372f_o and TS 10.1.0.0/24 192.168.0.2/32 === 10.3.0.1/32
09[ENC] generating IKE_AUTH response 115 [ AUTH CPRP(ADDR) SA TSi TSr N(MOBIKE_SUP) N(ADD_4_ADDR) ]
09[NET] sending packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (256 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The IKEv2 connection has been successfully established.</p>
</div>
<div class="paragraph">
<p><a href="swimaClient.html#_ikev2_authentication_success" class="xref page">SWIMA Client</a> &gt;</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security_updater"><a class="anchor" href="#_security_updater"></a>Security Updater</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="sec-updater.html" class="xref page"><code><strong>sec-updater</strong></code></a> tool is used in conjunction with
a <a href="https://github.com/strongswan/strongswan/blob/master/src/sec-updater/sec-updater.sh"><code><strong>sec-updater.sh</strong></code></a> script to periodically fetch security and update
information from the <strong>Debian</strong>, <strong>Ubuntu</strong>, <strong>Raspbian</strong> or other <code><strong>deb</strong></code> package-based
security websites, controlled e.g. by an hourly <code><strong>crontab</strong></code> entry</p>
</div>
<div class="listingblock">
<div class="content">
<pre># m  h dom mon dow   command
 10  *  *   *   *    /etc/pts/sec-updater.sh &gt;&gt; /etc/pts/sec-updater.log 2&gt;&amp;1</pre>
</div>
</div>
<div class="sect2">
<h3 id="_shell_script"><a class="anchor" href="#_shell_script"></a>Shell Script</h3>
<div class="paragraph">
<p>In our simple example we just want to fetch and process security information for
the <code><strong>Ubuntu 20.04 x86_64</strong></code> distribution</p>
</div>
<div class="listingblock">
<div class="title">Example sec-updater.sh script periodically run by cron</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">#!/bin/sh

DIR="/etc/pts"
DISTS_DIR="$DIR/dists"
DATE=`date +%Y%m%d-%H%M`
UBUNTU="http://security.ubuntu.com/ubuntu"
UBUNTU_VERSIONS="focal"
UBUNTU_DIRS="main multiverse restricted universe"
UBUNTU_ARCH="binary-amd64"
CMD=/usr/sbin/sec-updater
CMD_LOG="$DIR/logs/$DATE-sec-update.log"
DEL_LOG=1

mkdir -p $DIR/dists
cd $DIR/dists

# Download Ubuntu distribution information

for v in $UBUNTU_VERSIONS
do
  for a in $UBUNTU_ARCH
  do
    mkdir -p $v-security/$a $v-updates/$a
    for d in $UBUNTU_DIRS
    do
      wget -nv $UBUNTU/dists/$v-security/$d/$a/Packages.xz -O $v-security/$a/Packages-$d.xz
      unxz -f $v-security/$a/Packages-$d.xz
      wget -nv $UBUNTU/dists/$v-updates/$d/$a/Packages.xz  -O $v-updates/$a/Packages-$d.xz
      unxz -f $v-updates/$a/Packages-$d.xz
    done
  done
done

# Run sec-updater in distribution information

for f in focal-security/binary-amd64/*
do
  echo "security: $f"
  $CMD --os "Ubuntu 20.04" --arch "x86_64" --file $f --security \
       --uri $UBUNTU &gt;&gt; $CMD_LOG 2&gt;&amp;1
  if [ $? -eq 0 ]
  then
    DEL_LOG=0
  fi
done

for f in focal-updates/binary-amd64/*
do
  echo "updates:  $f"
  $CMD --os "Ubuntu 20.04" --arch "x86_64" --file $f \
       --uri $UBUNTU &gt;&gt; $CMD_LOG 2&gt;&amp;1
  if [ $? -eq 0 ]
  then
    DEL_LOG=0
  fi
done

# Delete log file if no security updates were found

if [ $DEL_LOG -eq 1 ]
then
  rm $CMD_LOG
  echo "no security updates found"
fi</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_log_file"><a class="anchor" href="#_log_file"></a>Log File</h3>
<div class="paragraph">
<p>The first time the <code><strong>sec-updater.sh</strong></code> script is run, all currently available security
information for the software packages already registered in the
<a href="strongTnc.html" class="xref page">strongTNC</a> database is directly stored in the SQLite <code><strong>config.db</strong></code>
database. Additionally the corresponding <code><strong>deb</strong></code> package fixing the vulnerability is
fetched from the URL given by the Linux distribution&#8217;s security web site and is
converted into a SWID tag using the <a href="https://github.com/strongswan/swidGenerator"><code><strong>swid_generator</strong></code></a>
tool and imported via the <code><strong>manage.py importswid</strong></code> <a href="https://github.com/strongswan/strongTNC">script</a> into
the <a href="strongTnc.html" class="xref page">strongTNC</a> database</p>
</div>
<div class="paragraph">
<p>The <code><strong>!</strong></code> symbol in the log file below designates vulnerable software package versions
and the <code><strong>+</strong></code> symbol defines the security update fixing the problem. The URL indicates
the location where the <code><strong>deb</strong></code> package of the updated version can be downloaded.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>apt
  !  2.0.2
  +  2.0.2ubuntu0.2
     http://security.ubuntu.com/ubuntu/pool/main/a/apt/apt_2.0.2ubuntu0.2_amd64.deb (1289696 bytes)
bash
  !  5.0-6ubuntu1.1
  !  5.0-6ubuntu1
  +  5.0-6ubuntu1.2
     http://security.ubuntu.com/ubuntu/pool/main/b/bash/bash_5.0-6ubuntu1.2_amd64.deb (638808 bytes)
....
util-linux
  !  2.34-0.1ubuntu9.1
  !  2.34-0.1ubuntu9
  +  2.34-0.1ubuntu9.3
     http://security.ubuntu.com/ubuntu/pool/main/u/util-linux/util-linux_2.34-0.1ubuntu9.3_amd64.deb (1021276 bytes)
zlib1g
  !  1:1.2.11.dfsg-2ubuntu1
  !  1:1.2.11.dfsg-2ubuntu1.2
Added Ubuntu_20.04-x86_64-apt-2.0.2ubuntu0.2
Added Ubuntu_20.04-x86_64-bash-5.0-6ubuntu1.2
...
Added Ubuntu_20.04-x86_64-util-linux-2.34-0.1ubuntu9.3
processed "focal-security/binary-amd64/Packages-main": 7871 packages, 35 new versions, 57 updated versions</pre>
</div>
</div>
<div class="paragraph">
<p>All security updates for the <strong>Ubuntu 20.04 x86_64</strong> <code><strong>main</strong></code> packages have been
processed above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>processed "focal-security/binary-amd64/Packages-multiverse": 85 packages, 0 new versions, 0 updated versions
processed "focal-security/binary-amd64/Packages-restricted": 5031 packages, 0 new versions, 0 updated versions</pre>
</div>
</div>
<div class="paragraph">
<p>No security updates for the <strong>Ubuntu 20.04 x86_64</strong> <code><strong>multiverse</strong></code> and <code><strong>restricted</strong></code>
packages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>python-pip-whl
  +  20.0.2-5ubuntu1.5
     http://security.ubuntu.com/ubuntu/pool/universe/p/python-pip/python-pip-whl_20.0.2-5ubuntu1.5_all.deb (1805236 bytes)
python3-pip
  +  20.0.2-5ubuntu1.5
     http://security.ubuntu.com/ubuntu/pool/universe/p/python-pip/python3-pip_20.0.2-5ubuntu1.5_all.deb (230484 bytes)
Added Ubuntu_20.04-x86_64-python-pip-whl-20.0.2-5ubuntu1.5
Added Ubuntu_20.04-x86_64-python3-pip-20.0.2-5ubuntu1.5
processed "focal-security/binary-amd64/Packages-universe": 3493 packages, 2 new versions, 0 updated versions</pre>
</div>
</div>
<div class="paragraph">
<p>All security updates for the <strong>Ubuntu 20.04 x86_64</strong> <code><strong>universe</strong></code> packages have been
processed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>apt
  +  2.0.6
     http://security.ubuntu.com/ubuntu/pool/main/a/apt/apt_2.0.6_amd64.deb (1295960 bytes)
base-files
  +  11ubuntu5.5
     http://security.ubuntu.com/ubuntu/pool/main/b/base-files/base-files_11ubuntu5.5_amd64.deb (60528 bytes)
...
ubuntu-keyring
  +  2020.02.11.4
     http://security.ubuntu.com/ubuntu/pool/main/u/ubuntu-keyring/ubuntu-keyring_2020.02.11.4_all.deb (22076 bytes)
Added Ubuntu_20.04-x86_64-apt-2.0.6
Added Ubuntu_20.04-x86_64-base-files-11ubuntu5.5
...
Added Ubuntu_20.04-x86_64-ubuntu-keyring-2020.02.11.4
processed "focal-updates/binary-amd64/Packages-main": 9474 packages, 15 new versions, 0 updated versions</pre>
</div>
</div>
<div class="paragraph">
<p>Non-security relevant updates have been added for the <strong>Ubuntu 20.04 x86_64</strong> <code><strong>main</strong></code>
packages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>processed "focal-updates/binary-amd64/Packages-multiverse": 102 packages, 0 new versions, 0 updated versions
processed "focal-updates/binary-amd64/Packages-restricted": 5371 packages, 0 new versions, 0 updated versions
processed "focal-updates/binary-amd64/Packages-universe": 4383 packages, 0 new versions, 0 updated versions</pre>
</div>
</div>
<div class="paragraph">
<p>No non-security updates for the Ubuntu 20.04 x86_64* <code><strong>multiverse</strong></code>, <code><strong>restricted</strong></code>
and <code><strong>universe</strong></code> packages.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="swimaClient.html">Software Inventory Client</a></span>
  <span class="next"><a href="measuredBoot.html">Measured Boot</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <a href="https://www.strongswan.org/"> 
     <img src="../../../_/img/strongswan.png" alt="strongSwan Logo" height="100"
        width="153" style="vertical-align:middle;float:left;margin:0px 20px"></a>
  <p>Copyright &copy; 2021-2023
     <a href="mailto:info@.strongswan.org">The strongSwan Team</a> and individual contributors.
     The <a href="https://github.com/strongswan/strongswan-docs">content</a>
     is provided under a <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license<p>
  <p>The <a href="https://github.com/strongswan/strongswan-antora">UI</a>
     for this site is derived from the Antora default UI and is licensed under
     the <a href="https://www.mozilla.org/en-US/MPL/2.0/">MPL-2.0</a> license.</p>
 </footer>

<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
