<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TNC Client :: strongSwan Documentation</title>
    <link rel="canonical" href="https://docs.strongswan.org/docs/5.9/tnc/tncClient.html">
    <link rel="prev" href="tnc.html">
    <link rel="next" href="tncServer.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-extra.css">
    <meta name="google-site-verification" content="pFYsGHXifqmasGBdCNNgzV4OxVDn2d3Zm0DK9WUYCl0" />
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.strongswan.org">strongSwan Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://strongswan.org">strongswan.org</a>
        <a class="navbar-item" href="https://download.strongswan.org">Downloads</a>
        <a class="navbar-item" href="https://github.com/strongswan">GitHub</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="6.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">strongSwan Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">News</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../news/whatsNew.html">What&#8217;s New in strongSwan 6.0</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/introduction.html">Introduction to strongSwan</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/ipsecProtocol.html">Introduction to IPsec</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/install.html">Installation Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/autoconf.html">Autoconf Options</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/kernelModules.html">Required Kernel Modules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../install/reducedPrivileges.html">Reduced Privileges</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/quickstart.html">Configuration Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../pki/pkiQuickstart.html">Certificates Quickstart</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/caManagement.html">GUI-based CA Management</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../config/config.html">Configuration Files</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/strongswanConf.html">strongswan.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../config/strongswanDir.html">strongswan.d Directory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlConf.html">swanctl.conf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlDir.html">swanctl Directory</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/IKEv2CipherSuites.html">IKEv2 Cipher Suites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/identityParsing.html">Identity Parsing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/jobPriority.html">Job Priority Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/lookupTuning.html">Tuning IKE SA Lookup</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/rekeying.html">IKE and IPsec SA Renewal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/retransmission.html">Retransmission</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/tlsOptions.html">TLS Options</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/sqliteDbSchema.html">SQLite Database Schema</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../config/IPv6Ndp.html">IPv6 and the Neighbor Discovery Protocol</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Features</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/vip.html">Virtual IP Addresses</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/mobike.html">MOBIKE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/natTraversal.html">NAT Traversal</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ipcomp.html">IPComp</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/networkManager.html">NetworkManager</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/routeBasedVpn.html">Route-based VPN</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/highAvailability.html">High Availability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/hashAndUrl.html">Hash and URL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/integrityTests.html">Integrity Tests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/ietf.html">IPsec and Related Standards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">How-tos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/forwarding.html">Forwarding and Split-Tunneling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/securityRecommendations.html">Security Recommendations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/smartcards.html">Smart Card Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/cloudPlatforms.html">Cloud Platforms</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/nameSpaces.html">strongSwan in Linux Network Namespaces</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/trafficDumps.html">Taking Traffic Dumps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Daemons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon.html">charon</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-systemd.html">charon-systemd</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-svc.html">charon-svc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../daemons/charon-cmd.html">charon-cmd</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Portability / OS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../os/android.html">Android</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClient.html">Android VPN Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientProfiles.html">Android VPN Client Profiles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientPrivacyPolicy.html">Android VPN Privacy Policy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../os/androidVpnClientBuild.html">Android VPN Client Build</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/windows.html">Windows</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/freebsd.html">FreeBSD</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../os/macos.html">macOS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Interoperability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html">Windows Clients</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/windowsCertRequirements.html">Windows Certificate Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_x_509_machine_certificates">Using Machine Certificates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineCert.html">Storing a Windows Machine Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineConf.html">Windows Client Configuration with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineConnect.html">Windows Client Connection with Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineServerConf.html">strongSwan Configuration for Windows Machine Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsMachineServerStatus.html">strongSwan Connection Status with Windows Machine Certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_x_509_user_certificates">Using User Certificates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserCert.html">Storing a Windows User Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsCaCert.html">Storing a Windows CA Certificate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserConf.html">Windows Client Configuration with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserConnect.html">Windows Client Connection with User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserServerConf.html">strongSwan Configuration for Windows User Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsUserServerStatus.html">strongSwan Connection Status with Windows User Certificates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/windowsClients.html#_using_passwords_with_eap_mschapv2">Using EAP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapConf.html">Windows Client EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapConnect.html">Windows Client EAP Connection with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapServerConf.html">strongSwan EAP Configuration with Passwords</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../interop/windowsEapServerStatus.html">strongSwan EAP Connection Status with Passwords</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/microsoftStatusNotify.html">Microsoft Status Notify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../interop/ios.html">iOS and macOS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../interop/appleIkev2Profile.html">Apple IKEv2 Configuration Profile</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../interop/fortinet.html">Fortinet Devices</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tools</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../swanctl/swanctl.html">swanctl Tool</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlCounters.html">swanctl --counters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlFlushCerts.html">swanctl --flush-certs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlInitiate.html">swanctl --initiate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlInstall.html">swanctl --install</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListAlgs.html">swanctl --list-algs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListAuths.html">swanctl --list-authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListCerts.html">swanctl --list-certs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListConns.html">swanctl --list-conns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListPols.html">swanctl --list-pols</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListPools.html">swanctl --list-pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlListSas.html">swanctl --list-sas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadAll.html">swanctl --load-all</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadAuths.html">swanctl --load-authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadConns.html">swanctl --load-conns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadCreds.html">swanctl --load-creds</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLoadPools.html">swanctl --load-pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlLog.html">swanctl --log</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlRedirect.html">swanctl --redirect</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlRekey.html">swanctl --rekey</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlReloadSettings.html">swanctl --reload-settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlStats.html">swanctl --stats</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlTerminate.html">swanctl --terminate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlUninstall.html">swanctl --uninstall</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../swanctl/swanctlVersion.html">swanctl --version</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../pki/pki.html">pki Tool</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiAcert.html">pki --acert</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiDn.html">pki --dn</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiEst.html">pki --est</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiEstCa.html">pki --estca</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiGen.html">pki --gen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiIssue.html">pki --issue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiKeyid.html">pki --keyid</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiOcsp.html">pki --ocsp</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPkcs12.html">pki --pkcs12</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPkcs7.html">pki --pkcs7</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPrint.html">pki --print</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiPub.html">pki --pub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiReq.html">pki --req</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiScep.html">pki --scep</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiScepCa.html">pki --scepca</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiSelf.html">pki --self</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiSignCrl.html">pki --signcrl</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../pki/pkiVerify.html">pki --verify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/cert-enroll.html">cert-enroll Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pt-tls-client.html">pt-tls-client Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sw-collector.html">sw-collector Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sec-updater.html">sec-updater Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/pool.html">ipsec pool Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="attest.html">ipsec attest Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/conftest.html">ipsec conftest Tool</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/scepclient.html">ipsec scepclient Tool</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugins</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../plugins/plugins.html">Plugin List</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/addrblock.html">addrblock Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/attr.html">attr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/attr-sql.html">attr-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/bypass-lan.html">bypass-lan Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/certexpire.html">certexpire Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/connmark.html">connmark Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/constraints.html">constraints Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/counters.html">counters Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/coupling.html">coupling Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/curl.html">curl Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/dhcp.html">dhcp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/duplicheck.html">duplicheck Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-dynamic.html">eap-dynamic Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-gtc.html">eap-gtc Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-radius.html">eap-radius Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-simaka-sql.html">eap-simaka-sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/eap-tls.html">eap-tls Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/error-notify.html">error-notify Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/ext-auth.html">ext-auth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/farp.html">farp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/forecast.html">forecast Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/ha.html">ha Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-iph.html">kernel-iph Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-libipsec.html">kernel-libipsec Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/kernel-wfp.html">kernel-wfp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/load-tester.html">load-tester Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/lookip.html">lookip Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/openxpki.html">openxpki Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/pkcs11.html">pkcs11 Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/radattr.html">radattr Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/resolve.html">resolve Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/save-keys.html">save-keys Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/selinux.html">selinux Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/socket-win.html">socket-win Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/sql.html">sql Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/systime-fix.html">systime-fix Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/test-vectors.html">test-vectors Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/tnc-ifmap.html">tnc-ifmap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/tpm.html">tpm Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/unity.html">unity Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/updown.html">updown Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/vici.html">vici Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/whitelist.html">whitelist Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/winhttp.html">winhttp Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-eap.html">xauth-eap Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-noauth.html">xauth-noauth Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/xauth-pam.html">xauth-pam Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugins/pluginLoad.html">Plugin Load Options</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/devs.html">Developer Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/contributions.html">Contributions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/programmingStyle.html">Programming Style</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/objectOrientedC.html">Object Oriented C</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/testingEnvironment.html">Testing Environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../devs/fuzzing.html">Fuzzing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Platform Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tpm/tpm2.html">TPM 2.0</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tpm/tpm2Ike.html">TPM 2.0 Use with strongSwan IKE Daemon</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="tnc.html">Trusted Network Connect</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="tncClient.html">TNC Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tncServer.html">TNC Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="optimumTncSizes.html">Optimum PB-TNC Batch and PA-TNC Message Sizes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="strongTnc.html">strongTNC</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="swima.html">Software Inventory</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="swimaClient.html">Software Inventory Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="swimaServer.html">Software Inventory Server</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="measuredBoot.html">Measured Boot</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="attestationClient.html">Attestation Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="attestationServer.html">Attestation Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pcrBootEvents.html">PCR Boot Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="ima.html">Integrity Measurement Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="imaClient.html">IMA Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="imaServer.html">IMA Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Support</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/helpRequests.html">Help Requests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/faq.html">FAQ</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/flawReporting.html">Flaw Reporting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/free.html">Free Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../support/commercial.html">Commercial Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Publications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publications/publications.html">Publications and Presentations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://strongswan.org/blog">strongSwan Blog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">strongSwan Docs</span>
    <span class="version">6.0 Beta</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../../5.9/index.html">strongSwan Docs</a></div>
      <ul class="versions">
        <li class="version is-current">
          <a href="../index.html">6.0 Beta</a>
        </li>
        <li class="version is-latest">
          <a href="../../5.9/index.html">5.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../5.9/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">strongSwan Docs</a></li>
    <li>Platform Security</li>
    <li><a href="tnc.html">Trusted Network Connect</a></li>
    <li><a href="tncClient.html">TNC Client</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">6.0 Beta</button>
  <div class="version-menu">
    <a class="version is-current" href="tncClient.html">6.0 Beta</a>
    <a class="version" href="../../5.9/tnc/tncClient.html">5.9</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/strongswan/strongswan-docs/edit/docs-6.0/docs/modules/ROOT/pages/tnc/tncClient.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">TNC Client</h1>
<div class="sect1">
<h2 id="_installation"><a class="anchor" href="#_installation"></a>Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to run a TNC client communicating via PT-EAP, in addition to the standard
strongSwan VPN configuration the following
<a href="../install/autoconf.html" class="xref page"><code><strong>./configure</strong></code></a> options have to be enabled</p>
</div>
<div class="literalblock">
<div class="content">
<pre>--enable-eap-identity --enable-eap-ttls --enable-eap-tnc --enable-tnccs-20 --enable-tnc-imc</pre>
</div>
</div>
<div class="paragraph">
<p>If client authentication is based on passwords instead of X.509 certificates,
additionally either the EAP-MD5 or EAP-MSCHAPv2 methods have to be enabled with
<code>--enable-eap-md5</code> or <code>--enable-eap-mschapv2</code>, respectively.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the <a href="../config/strongswanConf.html" class="xref page"><code><strong>strongswan.conf</strong></code></a> configuration file a
couple of important parameters have to been set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>charon {
  plugins {
    eap-ttls {
      max_message_count = 0
    }
    eap-tnc {
      max_message_count = 0
    }
    tnccs-20 {
      max_batch_size   = 32754
      max_message_size = 32722
    }
  }
}</pre>
</div>
</div>
<div class="sect2">
<h3 id="_message_size_restrictions"><a class="anchor" href="#_message_size_restrictions"></a>Message Size Restrictions</h3>
<div class="paragraph">
<p>Since often quite a lot of messages are exchanged via the PT-EAP transport protocol
protected by EAP-TTLS, the default upper limit set by the <code><strong>max_message_count</strong></code>
parameter of the
<a href="../config/strongswanConf.html#_charon_plugins_eap_tnc" class="xref page"><code><strong>eap-tnc</strong></code></a> and
<a href="../config/strongswanConf.html#_charon_plugins_eap_ttls" class="xref page"><code><strong>eap-ttls</strong></code></a> plugins
have to be disabled in order not to disrupt the communication.</p>
</div>
<div class="paragraph">
<p>It is also recommended to set the maximum PB-TNC batch size and the maximum
PA-TNC message size possible with PT-EAP transport to the
<a href="optimumTncSizes.html" class="xref page">optimum values</a> defined above.</p>
</div>
</div>
<div class="sect2">
<h3 id="_restriction_of_tls_cipher_suites"><a class="anchor" href="#_restriction_of_tls_cipher_suites"></a>Restriction of TLS Cipher Suites</h3>
<div class="paragraph">
<p>It is possible to restrict the TLS cipher suites proposed by the client
in a <a href="../config/strongswanConf.html#_libtls" class="xref page"><code><strong>libtls</strong></code></a> section of
<a href="../config/strongswanConf.html" class="xref page"><code><strong>strongswan.conf</strong></code></a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>libtls
{
  suites = TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
}</pre>
</div>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_configuration" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_integrity_measurement_collectors"><a class="anchor" href="#_integrity_measurement_collectors"></a>Integrity Measurement Collectors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Any number of Integrity Measurement Collectors (IMCs) can be attached to a TNC Client.
An IMC is a dynamic library which communicates with the TNC Client via the
<a href="https://trustedcomputinggroup.org/wp-content/uploads/TNC_IFIMC_v1_3_r18.pdf">TNC IF-IMC</a> API defined in the form of a C header file. The <code><strong>/etc/tnc_config</strong></code>
file tells the TNC Client which IMCs are to be loaded:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#IMC-Configuration

IMC "OS"             /usr/lib/ipsec/imcvs/imc-os.so
IMC "Scanner"        /usr/lib/ipsec/imcvs/imc-scanner.so
# IMC "SWIMA"        /usr/lib/ipsec/imcvs/imc-swima.so
# IMC "Attestation"  /usr/lib/ipsec/imcvs/imc-attestation.so</pre>
</div>
</div>
<div class="paragraph">
<p>In the configuration file above, the <code><strong>OS IMC</strong></code> and the <code><strong>Scanner IMC</strong></code> are enabled, so
that these Integrity Measurement Collectors have to be built beforehand with the
<a href="../install/autoconf.html" class="xref page"><code><strong>./configure</strong></code></a> options</p>
</div>
<div class="literalblock">
<div class="content">
<pre>--enable-imc-os --enable-imc-scanner</pre>
</div>
</div>
<div class="paragraph">
<p>When the <a href="../daemons/charon.html" class="xref page"><code><strong>charon</strong></code></a> daemon starts up, the IMCs are loaded.
<code><strong>IMC 1 OS</strong></code> and <code><strong>IMC 2 Scanner</strong></code> subcribe to the standard PA-TNC message subtypes
<code><strong>Operating System</strong></code> and <code><strong>Firewall</strong></code> defined in the <code><strong>IETF</strong></code> namespace, respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>00[DMN] Starting IKE charon daemon (strongSwan 5.9.7, Linux 5.13.0-35-generic, x86_64)
00[TNC] loading IMCs from '/etc/tnc_config'
00[TNC] added IETF attributes
00[TNC] added ITA-HSR attributes
00[TNC] added PWG attributes
00[TNC] added TCG attributes
00[LIB] libimcv initialized
00[IMC] IMC 1 "OS" initialized
00[IMC] processing "/etc/os-release" file
00[IMC] operating system type is 'Ubuntu'
00[IMC] operating system name is 'Ubuntu'
00[IMC] operating system version is '20.04 x86_64'
00[TNC] IMC 1 supports 1 message type: 'IETF/Operating System' 0x000000/0x00000001
00[TNC] IMC 1 "OS" loaded from '/usr/lib/ipsec/imcvs/imc-os.so'
00[IMC] IMC 2 "Scanner" initialized
00[TNC] IMC 2 supports 1 message type: 'IETF/Firewall' 0x000000/0x00000005
00[TNC] IMC 2 "Scanner" loaded from '/usr/lib/ipsec/imcvs/imc-scanner.so'</pre>
</div>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_integrity_measurement_verifiers" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tnc_enabled_vpn_client_configuration"><a class="anchor" href="#_tnc_enabled_vpn_client_configuration"></a>TNC-Enabled VPN Client Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After <a href="../daemons/charon.html" class="xref page"><code><strong>charon</strong></code></a> has loaded all its plugins and spawned
16 worker threads, the <a href="../swanctl/swanctl.html" class="xref page"><code><strong>swanctl</strong></code></a> start scripts load
the credentials and the connection configurations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>00[LIB] loaded plugins: charon random nonce x509 constraints pubkey pem openssl sqlite kernel-netlink resolve socket-default vici updown eap-identity eap-md5 eap-ttls eap-tnc tnc-imc tnc-tnccs tnccs-20
00[JOB] spawning 16 worker threads

00[DMN] executing start script 'creds' (swanctl --load-creds)
01[CFG] loaded certificate 'C=CH, O=Cyber, CN=client.strongswan.org'
09[CFG] loaded certificate 'C=CH, O=Cyber, CN=Cyber Root CA'
11[CFG] loaded ECDSA private key
01[CFG] loaded EAP shared key with id 'eap-hacker' for: 'hacker'
00[DMN] creds: loaded certificate from '/etc/swanctl/x509/clientCert.pem'
00[DMN] creds: loaded certificate from '/etc/swanctl/x509ca/caCert.pem'
00[DMN] creds: loaded ECDSA key from '/etc/swanctl/ecdsa/clientKey.pem'
00[DMN] creds: loaded eap secret 'eap-hacker'

00[DMN] executing start script 'conns' (swanctl --load-conns)
05[CFG] added vici connection: tnc
00[DMN] conns: loaded connection 'tnc'
00[DMN] conns: successfully loaded 1 connections, 0 unloaded</pre>
</div>
</div>
<div class="paragraph">
<p>The TNC-enabled VPN client configuration is based on the following
<a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a> file</p>
</div>
<div class="listingblock">
<div class="content">
<pre>connections {
  tnc {
    remote_addrs = 192.168.0.2
    vips = 0.0.0.0

    local {
      auth = eap-ttls
      # used with certificate-based EAP-TLS client authenticaton
      eap_id = client.strongswan.org
      # used with password-based EAP-MD5 client authentication
      # eap_id = hacker
    }
    remote {
      auth = eap-ttls
      id = server.strongswan.org
    }
    children {
      tnc {
        remote_ts = 10.1.0.0/16,192.168.0.2
        esp_proposals = aes256gcm128-x25519
      }
    }
    version = 2
    proposals = aes256-sha256-x25519
    send_certreq = no
  }
}

secrets {
  eap-hacker {
    id = hacker
    secret = K8FW9/N0VIAJ
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Two configuration variants are possible. The first that is currently enabled uses
certificate-based EAP client authentication whereas the second alternative that is
currently commented out is based on a preshared EAP secret. In the following we
are going to discuss both variants.</p>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_tnc_enabled_vpn_server_configuration" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_certificate_based_eap_client_authentication"><a class="anchor" href="#_certificate_based_eap_client_authentication"></a>Certificate-Based EAP Client Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The client authentication is based on an EAP Identity defined by</p>
</div>
<div class="literalblock">
<div class="content">
<pre>eap_id = client.strongswan.org</pre>
</div>
</div>
<div class="paragraph">
<p>as enabled in the configuration <a href="#_tnc_enabled_vpn_client_configuration">above</a>,
matched by an X.509 client certificate that is going to be used in the initial TLS
handshake of the EAP-TTLS method.</p>
</div>
<div class="paragraph">
<p>The <a href="../swanctl/swanctlListConns.html" class="xref page"><code><strong>swanctl --list-conns</strong></code></a> shows the loaded
VPN connection definition</p>
</div>
<div class="listingblock">
<div class="content">
<pre># swanctl --list-conns
tnc: IKEv2, no reauthentication, rekeying every 14400s
  local:  %any
  remote: 192.168.0.2
  local EAP_TTLS authentication:
    eap_id: client.strongswan.org
  remote EAP_TTLS authentication:
    id: server.strongswan.org
  tnc: TUNNEL, rekeying every 3600s
    local:  dynamic
    remote: 10.1.0.0/16 192.168.0.2/32</pre>
</div>
</div>
<div class="sect2">
<h3 id="_ikev2_connection_setup"><a class="anchor" href="#_ikev2_connection_setup"></a>IKEv2 Connection Setup</h3>
<div class="paragraph">
<p>The IPsec connection is started as usual with the
<a href="../swanctl/swanctlInitiate.html" class="xref page"><code><strong>swanctl --initiate</strong></code></a> command</p>
</div>
<div class="listingblock">
<div class="content">
<pre># swanctl --initiate --child tnc &gt; /dev/null
07[CFG] vici initiate CHILD_SA 'tnc'
08[IKE] initiating IKE_SA tnc[1] to 192.168.0.2
08[ENC] generating IKE_SA_INIT request 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) N(FRAG_SUP) N(HASH_ALG) N(REDIR_SUP) ]
08[NET] sending packet: from 192.168.0.3[500] to 192.168.0.2[500] (240 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>Since no IKE client identity has been explicitly defined, the client&#8217;s IP
address <code><strong>192.168.0.3</strong></code> is used by default. By sending the EAP_ONLY notify, the
client is signalling to the server that it is willing to accept <strong>EAP-only</strong>
authentication according to <a href="https://datatracker.ietf.org/doc/html/rfc5998">RFC5998</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>09[NET] received packet: from 192.168.0.2[500] to 192.168.0.3[500] (248 bytes)
09[ENC] parsed IKE_SA_INIT response 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) N(FRAG_SUP) N(HASH_ALG) N(CHDLESS_SUP) N(MULT_AUTH) ]
09[CFG] selected proposal: IKE:AES_CBC_256/HMAC_SHA2_256_128/PRF_HMAC_SHA2_256/CURVE_25519
09[CFG] no IDi configured, fall back on IP address
09[IKE] establishing CHILD_SA tnc{1}
09[ENC] generating IKE_AUTH request 1 [ IDi N(INIT_CONTACT) IDr CPRQ(ADDR DNS) SA TSi TSr N(MOBIKE_SUP) N(NO_ADD_ADDR) N(MULT_AUTH) N(EAP_ONLY) N(MSG_ID_SYN_SUP) ]
09[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (272 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>Since the VPN client didn&#8217;t include an AUTH payload in its IKE_AUTH request, the
VPN server switches to EAP-based authentication and at the outset requests an EAP
Identity. The client replies with its EAP Identity <code><strong>client.strongswan.org</strong></code>.
Due to the <strong>EAP-only</strong> mode, the server doesn&#8217;t include an AUTH payload in its
first IKE_AUTH response, either.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>06[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (112 bytes)
06[ENC] parsed IKE_AUTH response 1 [ IDr EAP/REQ/ID ]
06[IKE] server requested EAP_IDENTITY (id 0x00), sending 'client.strongswan.org'
06[IKE] allow mutual EAP-only authentication
06[ENC] generating IKE_AUTH request 2 [ EAP/RES/ID ]
06[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (96 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_ikev2_connection_setup" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_eap_ttls_tunnel_setup"><a class="anchor" href="#_eap_ttls_tunnel_setup"></a>EAP-TTLS Tunnel Setup</h3>
<div class="paragraph">
<p>Next the server requests EAP-TTLS which triggers the client to start a TLS handshake</p>
</div>
<div class="listingblock">
<div class="content">
<pre>09[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (80 bytes)
09[ENC] parsed IKE_AUTH response 2 [ EAP/REQ/TTLS ]
09[IKE] server requested EAP_TTLS authentication (id 0x45)
09[TLS] EAP_TTLS version is v0
09[ENC] generating IKE_AUTH request 3 [ EAP/RES/TTLS ]
09[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (272 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The negotiated TLS 1.2 cipher suite is <code>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</code>.
The server sends its TLS server certificate and the client responds by sending
its TLS client certificate</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (928 bytes)
10[ENC] parsed IKE_AUTH response 3 [ EAP/REQ/TTLS ]
10[TLS] negotiated TLS 1.2 using suite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
10[TLS] received TLS server certificate 'C=CH, O=Cyber, CN=server.strongswan.org'
10[CFG]   using certificate "C=CH, O=Cyber, CN=server.strongswan.org"
10[CFG]   using trusted ca certificate "C=CH, O=Cyber, CN=Cyber Root CA"
10[CFG]   reached self-signed root ca with a path length of 0
10[TLS] sending TLS client certificate 'C=CH, O=Cyber, CN=client.strongswan.org'
10[ENC] generating IKE_AUTH request 4 [ EAP/RES/TTLS ]
10[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (880 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The EAP-TTLS tunnel on top of IKEv2 EAP has been successfully established. Within
the tunnel the client&#8217;s EAP Identity is requested again</p>
</div>
<div class="listingblock">
<div class="content">
<pre>09[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (176 bytes)
09[ENC] parsed IKE_AUTH response 4 [ EAP/REQ/TTLS ]
09[IKE] received tunneled EAP-TTLS AVP [EAP/REQ/ID]
09[IKE] server requested EAP_IDENTITY authentication (id 0x00)
09[IKE] sending tunneled EAP-TTLS AVP [EAP/RES/ID]
09[ENC] generating IKE_AUTH request 5 [ EAP/RES/TTLS ]
09[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (144 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_eap_ttls_tunnel_setup" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_pb_tnc_connection_1"><a class="anchor" href="#_pb_tnc_connection_1"></a>PB-TNC Connection 1</h3>
<div class="paragraph">
<p>Now within the EAP-TTLS tunnel the PT-EAP transport protocol is started and the
<code><strong>PB-TNC</strong></code> (TCG TNC IF-TNCCS 2.0) Connection ID <code><strong>1</strong></code> is assigned to the connection
by the TNC client and a new state is created for both the <code><strong>OS IMC</strong></code> and the
<code><strong>Scanner IMC</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>16[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (128 bytes)
16[ENC] parsed IKE_AUTH response 5 [ EAP/REQ/TTLS ]
16[IKE] received tunneled EAP-TTLS AVP [EAP/REQ/PT]
16[IKE] server requested EAP_PT_EAP authentication (id 0xCC)
16[TLS] EAP_PT_EAP version is v1
16[TNC] TNC client is handling outbound connection
16[TNC] assigned TNCCS Connection ID 1
16[IMC] IMC 1 "OS" created a state for IF-TNCCS 2.0 Connection ID 1: +long +excl -soh
16[IMC]   over IF-T for Tunneled EAP 2.0 with maximum PA-TNC message size of 32722 bytes
16[IMC] IMC 2 "Scanner" created a state for IF-TNCCS 2.0 Connection ID 1: +long +excl -soh
16[IMC]   over IF-T for Tunneled EAP 2.0 with maximum PA-TNC message size of 32722 bytes
16[IMC] IMC 1 "OS" changed state of Connection ID 1 to 'Handshake'
16[IMC] IMC 2 "Scanner" changed state of Connection ID 1 to 'Handshake'</pre>
</div>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_pb_tnc_connection_1" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_tnc_measurements"><a class="anchor" href="#_tnc_measurements"></a>TNC Measurements</h3>
<div class="paragraph">
<p>The <code><strong>OS IMC</strong></code> gathers information on the operating system and creates seven PA-TNC
attributes and puts them in a PA-TNC message of the standard subtype
<code><strong>Operating System</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>16[IMC] operating system numeric version is 20.4
16[IMC] last boot: Mar 28 07:42:58 UTC 2022, 39621 s ago
16[IMC] IPv4 forwarding is enabled
16[IMC] factory default password is disabled
16[IMC] device ID is a488651e36664792b306cf8be72dd630
16[TNC] creating PA-TNC message with ID 0x0f74f43f
16[TNC] creating PA-TNC attribute type 'IETF/Product Information' 0x000000/0x00000002
16[TNC] creating PA-TNC attribute type 'IETF/String Version' 0x000000/0x00000004
16[TNC] creating PA-TNC attribute type 'IETF/Numeric Version' 0x000000/0x00000003
16[TNC] creating PA-TNC attribute type 'IETF/Operational Status' 0x000000/0x00000005
16[TNC] creating PA-TNC attribute type 'IETF/Forwarding Enabled' 0x000000/0x0000000b
16[TNC] creating PA-TNC attribute type 'IETF/Factory Default Password Enabled' 0x000000/0x0000000c
16[TNC] creating PA-TNC attribute type 'ITA-HSR/Device ID' 0x00902a/0x00000008
16[TNC] creating PB-PA message type 'IETF/Operating System' 0x000000/0x00000001</pre>
</div>
</div>
<div class="paragraph">
<p>The <code><strong>Scanner IMC</strong></code> determines all open listening ports using <code><strong>netstat</strong></code> and puts
the port list into a PA-TNC attribute which in turn is embedded in a PA-TNC
message of standard subtype <code><strong>Firewall</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>16[IMC] Active Internet connections (only servers)
16[IMC] Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
16[IMC] tcp        0      0 127.0.0.11:41963        0.0.0.0:*               LISTEN      -
16[IMC] udp        0      0 0.0.0.0:4500            0.0.0.0:*                           17/./charon
16[IMC] udp        0      0 127.0.0.11:47753        0.0.0.0:*                           -
16[IMC] udp        0      0 0.0.0.0:500             0.0.0.0:*                           17/./charon
16[IMC] udp6       0      0 :::4500                 :::*                                17/./charon
16[IMC] udp6       0      0 :::500                  :::*                                17/./charon
16[TNC] creating PA-TNC message with ID 0x0dc7be19
16[TNC] creating PA-TNC attribute type 'IETF/Port Filter' 0x000000/0x00000006
16[TNC] creating PB-PA message type 'IETF/Firewall' 0x000000/0x00000005</pre>
</div>
</div>
<div class="paragraph">
<p>Both PA-TNC messages are put into a PB-TNC Client Data batch and are sent to the
TNC server</p>
</div>
<div class="listingblock">
<div class="content">
<pre>16[TNC] PB-TNC state transition from 'Init' to 'Server Working'
16[TNC] creating PB-TNC CDATA batch
16[TNC] adding IETF/PB-Language-Preference message
16[TNC] adding IETF/PB-PA message
16[TNC] adding IETF/PB-PA message
16[TNC] sending PB-TNC CDATA batch (321 bytes) for Connection ID 1
16[IKE] sending tunneled EAP-TTLS AVP [EAP/RES/PT]
16[ENC] generating IKE_AUTH request 6 [ EAP/RES/TTLS ]
16[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (448 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>A PB-TNC Server Data batch containing two PA-TNC messages is received by the TNC
client.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>05[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (640 bytes)
05[ENC] parsed IKE_AUTH response 6 [ EAP/REQ/TTLS ]
05[IKE] received tunneled EAP-TTLS AVP [EAP/REQ/PT]
05[TNC] received TNCCS batch (512 bytes)
05[TNC] TNC client is handling inbound connection
05[TNC] processing PB-TNC SDATA batch for Connection ID 1
05[TNC] PB-TNC state transition from 'Server Working' to 'Client Working'
05[TNC] processing IETF/PB-PA message (72 bytes)
05[TNC] processing IETF/PB-PA message (432 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The first PA-TNC message is of standard subtype <code><strong>Operating System</strong></code> and contains
a PA-TNC attribute of type <code><strong>Segmentation Contract Request</strong></code> defined in the <code><strong>TCG</strong></code>
namespace which proposes to split up huge PA-TNC messages into segments with a
maximum size of <code><strong>32'698</strong></code> bytes each (see
<a href="optimumTncSizes.html#_pa_tnc_message_segmentation" class="xref page">PA-TNC message segmentation</a>),
plus a second PA-TNC attribute of the standard type <code><strong>Attribute Request</strong></code> which
requests a PA-TNC attribute of standard type <code><strong>Installed Packages</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>05[TNC] handling PB-PA message type 'IETF/Operating System' 0x000000/0x00000001
05[IMC] IMC 1 "OS" received message for Connection ID 1 from IMV 1
05[TNC] processing PA-TNC message with ID 0xc084b149
05[TNC] processing PA-TNC attribute type 'TCG/Segmentation Contract Request' 0x005597/0x00000021
05[TNC] processing PA-TNC attribute type 'IETF/Attribute Request' 0x000000/0x00000001
05[TNC]   0x000000/0x00000007 'IETF/Installed Packages'
05[IMC] IMC 1 received a segmentation contract request from IMV 1 for PA message type 'IETF/Operating System' 0x000000/0x00000001
05[IMC]   no message size limit, maximum segment size of 32698 bytes</pre>
</div>
</div>
<div class="paragraph">
<p>The <code><strong>OS IMC</strong></code> compiles a list of all installed Ubuntu packages for the
<code><strong>Installed Packages</strong></code> PA-TNC attribute and puts it into a PA-TNC message of
standard subtype <code><strong>Operating System</strong></code> together with the <code><strong>Segmentation Contract Response</strong></code>
PA-TNC attribute defined in the <code><strong>TCG</strong></code> namespace</p>
</div>
<div class="listingblock">
<div class="content">
<pre>05[IMC] package 'adduser' (3.118ubuntu2)
05[IMC] package 'apt' (2.0.4)
05[IMC] package 'base-files' (11ubuntu5.3)
05[IMC] package 'base-passwd' (3.5.47)
        ...
05[IMC] package 'tar' (1.30+dfsg-7ubuntu0.20.04.1)
05[IMC] package 'ubuntu-keyring' (2020.02.11.2)
05[IMC] package 'util-linux' (2.34-0.1ubuntu9.1)
05[IMC] package 'zlib1g' (1:1.2.11.dfsg-2ubuntu1.2)
05[TNC] creating PA-TNC message with ID 0x6e31e351
05[TNC] creating PA-TNC attribute type 'TCG/Segmentation Contract Response' 0x005597/0x00000022
05[TNC] creating PA-TNC attribute type 'IETF/Installed Packages' 0x000000/0x00000007
05[TNC] creating PB-PA message type 'IETF/Operating System' 0x000000/0x00000001</pre>
</div>
</div>
<div class="paragraph">
<p>The <code><strong>Scanner IMC</strong></code> processes the second PA-TNC message of standard subtype
<code><strong>Firewall</strong></code> which contains the standard PA-TNC attributes <code><strong>Assessment Result</strong></code>
and <code><strong>Remediation Instructions</strong></code> which contain the result <code><strong>non-compliant minor</strong></code>
and the remediation to close the TCP server port <code><strong>41963</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>05[TNC] handling PB-PA message type 'IETF/Firewall' 0x000000/0x00000005
05[IMC] IMC 2 "Scanner" received message for Connection ID 1 from IMV 2
05[TNC] processing PA-TNC message with ID 0x26d87477
05[TNC] processing PA-TNC attribute type 'IETF/Assessment Result' 0x000000/0x00000009
05[TNC] processing PA-TNC attribute type 'IETF/Remediation Instructions' 0x000000/0x0000000a
05[IMC] ***** assessment of IMC 2 "Scanner" from IMV 2 *****
05[IMC] assessment result is 'non-compliant minor'
05[IMC] remediation string: [en]
05[IMC] &lt;?xml version="1.0" encoding="UTF-8"?&gt;
05[IMC] &lt;remediationinstructions&gt;
05[IMC]   &lt;instruction&gt;
05[IMC]     &lt;title&gt;Open Server Ports&lt;/title&gt;
05[IMC]     &lt;description&gt;Open Internet ports have been detected&lt;/description&gt;
05[IMC]     &lt;itemsheader&gt;Please close the following server ports:&lt;/itemsheader&gt;
05[IMC]     &lt;items&gt;
05[IMC]       &lt;item&gt;tcp/41963&lt;/item&gt;
05[IMC]     &lt;/items&gt;
05[IMC]   &lt;/instruction&gt;
05[IMC] &lt;/remediationinstructions&gt;
05[IMC] ***** end of assessment *****</pre>
</div>
</div>
<div class="paragraph">
<p>The PA-TNC message containing the <code><strong>Installed Packages</strong></code> standard attribute is
sent in a PB-TNC Client Data batch to the TNC server. Since the batch with a
size of 2845 bytes is quite large, it is broken up into three EAP-TTLS segments</p>
</div>
<div class="listingblock">
<div class="content">
<pre>05[TNC] TNC client is handling outbound connection
05[TNC] PB-TNC state transition from 'Client Working' to 'Server Working'
05[TNC] creating PB-TNC CDATA batch
05[TNC] adding IETF/PB-PA message
05[TNC] sending PB-TNC CDATA batch (2845 bytes) for Connection ID 1
05[IKE] sending tunneled EAP-TTLS AVP [EAP/RES/PT]
05[ENC] generating IKE_AUTH request 7 [ EAP/RES/TTLS ]
05[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (1104 bytes)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>06[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (80 bytes)
06[ENC] parsed IKE_AUTH response 7 [ EAP/REQ/TTLS ]
06[ENC] generating IKE_AUTH request 8 [ EAP/RES/TTLS ]
06[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (1104 bytes)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>05[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (80 bytes)
05[ENC] parsed IKE_AUTH response 8 [ EAP/REQ/TTLS ]
05[ENC] generating IKE_AUTH request 9 [ EAP/RES/TTLS ]
05[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (944 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>A PB-TNC Result batch is received by the TNC client. It contains a PA-TNC message
of standard subtype <code><strong>Operating System</strong></code> directed to the <code><strong>OS IMC</strong></code> and carries
a standard <code><strong>Assessment Result</strong></code> PA-TNC attribute with the value <code><strong>compliant</strong></code>.</p>
</div>
<div class="paragraph">
<p>Additionally the PB-TNC Result batch contains the three standard PB-TNC messages
of standard types <code><strong>PB-Assessment-Result</strong></code>, <code><strong>PB-Access-Recommendation</strong></code>, and
<code><strong>PB-Reason-String</strong></code> with the values <code><strong>non-compliant minor</strong></code>, <code><strong>Access Denied</strong></code>
and <code><strong>Open server ports were detected</strong></code>, respectively.</p>
</div>
<div class="paragraph">
<p>Finally the TNC client sends a PB-TNC Close batch to the TNC server, closing
down the PA-TNC Connection with ID <code><strong>1</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>06[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (272 bytes)
06[ENC] parsed IKE_AUTH response 9 [ EAP/REQ/TTLS ]
06[IKE] received tunneled EAP-TTLS AVP [EAP/REQ/PT]
06[TNC] received TNCCS batch (138 bytes)
06[TNC] TNC client is handling inbound connection
06[TNC] processing PB-TNC RESULT batch for Connection ID 1
06[TNC] PB-TNC state transition from 'Server Working' to 'Decided'
06[TNC] processing IETF/PB-PA message (48 bytes)
06[TNC] processing IETF/PB-Assessment-Result message (16 bytes)
06[TNC] processing IETF/PB-Access-Recommendation message (16 bytes)
06[TNC] processing IETF/PB-Reason-String message (50 bytes)
06[TNC] handling PB-PA message type 'IETF/Operating System' 0x000000/0x00000001
06[IMC] IMC 1 "OS" received message for Connection ID 1 from IMV 1
06[TNC] processing PA-TNC message with ID 0x8341ae40
06[TNC] processing PA-TNC attribute type 'IETF/Assessment Result' 0x000000/0x00000009
06[IMC] ***** assessment of IMC 1 "OS" from IMV 1 *****
06[IMC] assessment result is 'compliant'
06[IMC] ***** end of assessment *****
06[TNC] PB-TNC assessment result is 'non-compliant minor'
06[TNC] PB-TNC access recommendation is 'Access Denied'
06[IMC] IMC 1 "OS" changed state of Connection ID 1 to 'None'
06[IMC] IMC 2 "Scanner" changed state of Connection ID 1 to 'None'
06[TNC] reason string is 'Open server ports were detected' [en]
06[TNC] TNC client is handling outbound connection
06[TNC] PB-TNC state transition from 'Decided' to 'End'
06[TNC] creating PB-TNC CLOSE batch
06[TNC] sending PB-TNC CLOSE batch (8 bytes) for Connection ID 1
06[IKE] sending tunneled EAP-TTLS AVP [EAP/RES/PT]
06[ENC] generating IKE_AUTH request 10 [ EAP/RES/TTLS ]
06[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (144 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The VPN server and subsequently the VPN client close the EAP-TTLS tunnel over
IKEv2 EAP since it is not needed anymore for TNC measurements</p>
</div>
<div class="listingblock">
<div class="content">
<pre>10[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (112 bytes)
10[ENC] parsed IKE_AUTH response 10 [ EAP/REQ/TTLS ]
10[TLS] received TLS close notify
10[TLS] sending TLS close notify
10[ENC] generating IKE_AUTH request 11 [ EAP/RES/TTLS ]
10[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (112 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_tnc_measurements" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_ikev2_authentication_failure"><a class="anchor" href="#_ikev2_authentication_failure"></a>IKEv2 Authentication Failure</h3>
<div class="paragraph">
<p>Since the overall PB-TNC <code><strong>PB-Assessment-Recommendation</strong></code> was <code><strong>Access Denied</strong></code>
due to the open TCP server port, the IKEv2 negotiation aborts as well. The PB-TNC
Connection <code><strong>1</strong></code> is removed and the states of the <code><strong>OS IMC</strong></code> and <code><strong>Scanner IMC</strong></code>
are deleted</p>
</div>
<div class="listingblock">
<div class="content">
<pre>09[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (80 bytes)
09[ENC] parsed IKE_AUTH response 11 [ EAP/FAIL ]
09[IKE] received EAP_FAILURE, EAP authentication failed
09[ENC] generating INFORMATIONAL request 12 [ N(AUTH_FAILED) ]
09[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (80 bytes)
09[IMC] IMC 1 "OS" deleted the state of Connection ID 1
09[IMC] IMC 2 "Scanner" deleted the state of Connection ID 1
09[TNC] removed TNCCS Connection ID 1
initiate failed: establishing CHILD_SA 'tnc' failed</pre>
</div>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_ikev2_authentication_failure" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_psk_based_eap_client_authentication"><a class="anchor" href="#_psk_based_eap_client_authentication"></a>PSK-Based EAP Client Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Alternatively a preshared EAP secret could be used with EAP-MD5 or EAP-MSCHAPv2
within EAP-TTLS by enabling the EAP Identity</p>
</div>
<div class="literalblock">
<div class="content">
<pre>eap_id = hacker</pre>
</div>
</div>
<div class="paragraph">
<p>in the configuration file <a href="../swanctl/swanctlConf.html" class="xref page"><code><strong>swanctl.conf</strong></code></a> defined
<a href="#_tnc_enabled_vpn_client_configuration">above</a> and then reloading the edited
configuration with the <a href="../swanctl/swanctlLoadConns.html" class="xref page"><code><strong>swanctl --load-conns</strong></code></a>
command. The <a href="../swanctl/swanctlListConns.html" class="xref page"><code><strong>swanctl --list-conns</strong></code></a> then
shows the reloaded VPN connection definition</p>
</div>
<div class="listingblock">
<div class="content">
<pre>swanctl --list-conns
tnc: IKEv2, no reauthentication, rekeying every 14400s
  local:  %any
  remote: 192.168.0.2
  local EAP_TTLS authentication:
    eap_id: hacker
  remote EAP_TTLS authentication:
    id: server.strongswan.org
  tnc: TUNNEL, rekeying every 3600s
    local:  dynamic
    remote: 10.1.0.0/16 192.168.0.2/32</pre>
</div>
</div>
<div class="sect2">
<h3 id="_ikev2_connection_setup_2"><a class="anchor" href="#_ikev2_connection_setup_2"></a>IKEv2 Connection Setup</h3>
<div class="paragraph">
<p>The IPsec connection is again started with the
<a href="../swanctl/swanctlInitiate.html" class="xref page"><code><strong>swanctl --initiate</strong></code></a> command</p>
</div>
<div class="listingblock">
<div class="content">
<pre># swanctl --initiate --child tnc &gt; /dev/null
10[CFG] vici initiate CHILD_SA 'tnc'
01[IKE] initiating IKE_SA tnc[2] to 192.168.0.2
01[ENC] generating IKE_SA_INIT request 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) N(FRAG_SUP) N(HASH_ALG) N(REDIR_SUP) ]
01[NET] sending packet: from 192.168.0.3[500] to 192.168.0.2[500] (240 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>Since no IKE client identity has been explicitly defined, the client&#8217;s IP
address <code><strong>192.168.0.3</strong></code> is used by default. By sending the EAP_ONLY notify the
client is signalling to the server that it is willing to accept <strong>EAP-only</strong>
authentication according to <a href="https://datatracker.ietf.org/doc/html/rfc5998">RFC5998</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>14[NET] received packet: from 192.168.0.2[500] to 192.168.0.3[500] (248 bytes)
14[ENC] parsed IKE_SA_INIT response 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) N(FRAG_SUP) N(HASH_ALG) N(CHDLESS_SUP) N(MULT_AUTH) ]
14[CFG] selected proposal: IKE:AES_CBC_256/HMAC_SHA2_256_128/PRF_HMAC_SHA2_256/CURVE_25519
14[CFG] no IDi configured, fall back on IP address
14[IKE] establishing CHILD_SA tnc{2}
14[ENC] generating IKE_AUTH request 1 [ IDi N(INIT_CONTACT) IDr CPRQ(ADDR DNS) SA TSi TSr N(MOBIKE_SUP) N(NO_ADD_ADDR) N(MULT_AUTH) N(EAP_ONLY) N(MSG_ID_SYN_SUP) ]
14[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (272 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>Since the VPN client didn&#8217;t include an AUTH payload in its IKE_AUTH request, the
VPN server switches to EAP-based authentication and at the outset requests an EAP
Identity. The client replies with its EAP Identity <code><strong>hacker</strong></code>. Due to the <strong>EAP-only</strong>
mode, the server doesn&#8217;t include an AUTH payload in its first IKE_AUTH response,
either.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>13[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (112 bytes)
13[ENC] parsed IKE_AUTH response 1 [ IDr EAP/REQ/ID ]
13[IKE] server requested EAP_IDENTITY (id 0x00), sending 'hacker'
13[IKE] allow mutual EAP-only authentication
13[ENC] generating IKE_AUTH request 2 [ EAP/RES/ID ]
13[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (80 bytes)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_eap_ttls_tunnel_setup_2"><a class="anchor" href="#_eap_ttls_tunnel_setup_2"></a>EAP-TTLS Tunnel Setup</h3>
<div class="paragraph">
<p>Next the server requests EAP-TTLS which triggers the client to start a TLS handshake</p>
</div>
<div class="listingblock">
<div class="content">
<pre>14[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (80 bytes)
14[ENC] parsed IKE_AUTH response 2 [ EAP/REQ/TTLS ]
14[IKE] server requested EAP_TTLS authentication (id 0x86)
14[TLS] EAP_TTLS version is v0
14[ENC] generating IKE_AUTH request 3 [ EAP/RES/TTLS ]
14[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (272 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The negotiated TLS 1.2 cipher suite is <code>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</code>.
The server sends its TLS server certificate</p>
</div>
<div class="listingblock">
<div class="content">
<pre>06[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (896 bytes)
06[ENC] parsed IKE_AUTH response 3 [ EAP/REQ/TTLS ]
06[TLS] negotiated TLS 1.2 using suite TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
06[TLS] received TLS server certificate 'C=CH, O=Cyber, CN=server.strongswan.org'
06[CFG]   using certificate "C=CH, O=Cyber, CN=server.strongswan.org"
06[CFG]   using trusted ca certificate "C=CH, O=Cyber, CN=Cyber Root CA"
06[CFG]   reached self-signed root ca with a path length of 0
06[ENC] generating IKE_AUTH request 4 [ EAP/RES/TTLS ]
06[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (240 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>The EAP-TTLS tunnel on top of IKEv2 EAP has been successfully established. Within
the tunnel the client&#8217;s EAP Identity is requested again</p>
</div>
<div class="listingblock">
<div class="content">
<pre>05[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (176 bytes)
05[ENC] parsed IKE_AUTH response 4 [ EAP/REQ/TTLS ]
05[IKE] received tunneled EAP-TTLS AVP [EAP/REQ/ID]
05[IKE] server requested EAP_IDENTITY authentication (id 0x00)
05[IKE] sending tunneled EAP-TTLS AVP [EAP/RES/ID]
05[ENC] generating IKE_AUTH request 5 [ EAP/RES/TTLS ]
05[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (128 bytes)</pre>
</div>
</div>
<div class="paragraph">
<p>Within the EAP-TTLS tunnel the EAP-MD5 authentication based on the EAP preshared
secret is done</p>
</div>
<div class="listingblock">
<div class="content">
<pre>13[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (144 bytes)
13[ENC] parsed IKE_AUTH response 5 [ EAP/REQ/TTLS ]
13[IKE] received tunneled EAP-TTLS AVP [EAP/REQ/MD5]
13[IKE] server requested EAP_MD5 authentication (id 0xD4)
13[IKE] sending tunneled EAP-TTLS AVP [EAP/RES/MD5]
13[ENC] generating IKE_AUTH request 6 [ EAP/RES/TTLS ]
13[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (144 bytes)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pb_tnc_connection_2"><a class="anchor" href="#_pb_tnc_connection_2"></a>PB-TNC Connection 2</h3>
<div class="paragraph">
<p>Again the PT-EAP transport protocol is started within the EAP-TTLS tunnel and the
PB-TNC (TCG IF-TNCCS) Connection ID <code><strong>2</strong></code> is assigned to the connection by the TNC
client and a fresh state is created for both the <code><strong>OS IMC</strong></code> and the <code><strong>Scanner IMC</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>08[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (128 bytes)
08[ENC] parsed IKE_AUTH response 6 [ EAP/REQ/TTLS ]
08[IKE] received tunneled EAP-TTLS AVP [EAP/REQ/PT]
08[IKE] server requested EAP_PT_EAP authentication (id 0x09)
08[TLS] EAP_PT_EAP version is v1
08[TNC] TNC client is handling outbound connection
08[TNC] assigned TNCCS Connection ID 2
08[IMC] IMC 1 "OS" created a state for IF-TNCCS 2.0 Connection ID 2: +long +excl -soh
08[IMC]   over IF-T for Tunneled EAP 2.0 with maximum PA-TNC message size of 32722 bytes
08[IMC] IMC 2 "Scanner" created a state for IF-TNCCS 2.0 Connection ID 2: +long +excl -soh
08[IMC]   over IF-T for Tunneled EAP 2.0 with maximum PA-TNC message size of 32722 bytes
08[IMC] IMC 1 "OS" changed state of Connection ID 2 to 'Handshake'
08[IMC] IMC 2 "Scanner" changed state of Connection ID 2 to 'Handshake'</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tnc_measurements_2"><a class="anchor" href="#_tnc_measurements_2"></a>TNC Measurements</h3>
<div class="paragraph">
<p>The TNC measurements are the <a href="#_tnc_measurements">same</a> as in the previous
PB-TNC connection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ikev2_authentication_failure_2"><a class="anchor" href="#_ikev2_authentication_failure_2"></a>IKEv2 Authentication Failure</h3>
<div class="paragraph">
<p>Since the overall PB-TNC <code><strong>PB-Assessment-Recommendation</strong></code> was <code><strong>Access Denied</strong></code>
due to the open TCP server port, the IKEv2 negotiation aborts as well. The PB-TNC
Connection <code><strong>2</strong></code> is removed and the states of the <code><strong>OS IMC</strong></code> and <code><strong>Scanner IMC</strong></code>
are deleted</p>
</div>
<div class="listingblock">
<div class="content">
<pre>09[NET] received packet: from 192.168.0.2[4500] to 192.168.0.3[4500] (80 bytes)
09[ENC] parsed IKE_AUTH response 9 [ EAP/FAIL ]
09[IKE] received EAP_FAILURE, EAP authentication failed
09[ENC] generating INFORMATIONAL request 10 [ N(AUTH_FAILED) ]
09[NET] sending packet: from 192.168.0.3[4500] to 192.168.0.2[4500] (80 bytes)
09[IMC] IMC 1 "OS" deleted the state of Connection ID 2
09[IMC] IMC 2 "Scanner" deleted the state of Connection ID 2
09[TNC] removed TNCCS Connection ID 2
initiate failed: establishing CHILD_SA 'tnc' failed</pre>
</div>
</div>
<div class="paragraph">
<p><a href="tncServer.html#_ikev2_authentication_failure_2" class="xref page">TNC Server</a> &gt;</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="tnc.html">Trusted Network Connect</a></span>
  <span class="next"><a href="tncServer.html">TNC Server</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <a href="https://www.strongswan.org/"> 
     <img src="../../../_/img/strongswan.png" alt="strongSwan Logo" height="100"
        width="153" style="vertical-align:middle;float:left;margin:0px 20px"></a>
  <p>Copyright &copy; 2021-2023
     <a href="mailto:info@.strongswan.org">The strongSwan Team</a> and individual contributors.
     The <a href="https://github.com/strongswan/strongswan-docs">content</a>
     is provided under a <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license<p>
  <p>The <a href="https://github.com/strongswan/strongswan-antora">UI</a>
     for this site is derived from the Antora default UI and is licensed under
     the <a href="https://www.mozilla.org/en-US/MPL/2.0/">MPL-2.0</a> license.</p>
 </footer>

<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
